/*!CK:3146898552!*//*1451977672,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["QhUlw"]); }

__d("MNCommerceLoggerEvents",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={GEN_CALL:"gen_call",DUPLICATE_CALL:"duplicate_call",ERROR:"error",GEN_SHIPMENT_ENT:"gen_shipment_ent",GEN_SHIPMENT_TRACKING_ENT:"gen_shipment_tracking_ent",SHIPMENT_NOTIFICATION_READY:"shipment_notification_ready",SHIPMENT_NOTIFICATION_SENT:"shipment_notification_sent",SHIPMENT_NOTIF_READY:"shipment_notif_ready",SHIPMENT_NOTIF_SENT:"shipment_notif_sent",ETA_NOTIF_READY:"eta_notif_ready",ETA_NOTIF_SENT:"eta_notif_sent",DELIVERED_NOTIF_READY:"delivered_notif_ready",DELIVERED_NOTIF_SENT:"delivered_notif_sent",OUT_FOR_DELIVERY_NOTIF_READY:"out_for_delivery_notif_ready",OUT_FOR_DELIVERY_NOTIF_SENT:"out_for_delivery_notif_sent",DELAYED_NOTIF_READY:"delayed_notif_ready",DELAYED_NOTIF_SENT:"delayed_notif_sent",IN_TRANSIT_NOTIF_READY:"in_transit_notif_ready",IN_TRANSIT_NOTIF_SENT:"in_transit_notif_sent",ASYNC_EXECUTION:"async_execution",ASYNC_SCHEDULE:"async_schedule",ASYNC_THROTTLE:"async_throttle",ASYNC_USER_ACCOUNT_DISABLED:"async_user_account_disabled",ASYNC_GEN_DATA_ERROR:"async_gen_data_error",TRACKING_SHUTDOWN_WITH_EXCEPTION_ERROR:"tracking_shutdown_with_exception",TRACKING_SHUTDOWN_WITH_RETRY_ERROR:"tracking_shutdown_with_retry",DELIVERED_STATS:"delivered_stats",USER_LINKED:"user_linked",USER_LINK_FAILED:"user_link_failed",USER_TOKEN_DECRYPTION_FAILED:"user_token_decryption_failed",USER_TOKEN_DELIVERY_ATTEMPT:"user_token_delivery_attempt",USER_TOKEN_DELIVERED:"user_token_delivered",USER_TOKEN_DELIVERY_FAILED:"user_token_delivery_failed",USER_TOKEN_CRITICAL_LOOKUP:"user_token_critical_lookup",USER_TOKEN_LOOKUP_FAILED:"user_token_lookup_failed",USER_UNLINKED:"user_unlinked",USER_UNLINK_FAILED:"user_unlink_failed",USER_UNLINK_BUSINESS_NOTIFIED:"user_unlink_business_notified",USER_UNLINK_BUSINESS_NOTIFICATION_FAILED:"user_unlink_business_notification_failed",PLUGIN_CLIENT_RENDERED:"plugin_client_rendered",PLUGIN_RENDERED:"plugin_rendered",PLUGIN_HIDDEN_ALREADY_LINKED:"plugin_hidden_already_linked",PLUGIN_BLOCKED:"plugin_blocked",PLUGIN_UPDATES_DISALLOWED:"plugin_updates_disallowed",PLUGIN_UPDATES_REALLOWED:"plugin_updates_reallowed",PLUGIN_ASSOC_MUTATE_FAILED:"plugin_assoc_mutate_failed",PLUGIN_ASSOC_READ_FAILED:"plugin_assoc_read_failed",PLUGIN_MESSAGE_US_CLICK:"plugin_message_us_click",ORDER_CANCELLED:"order_cancelled",ORDER_CANCELLATION_FAILED:"order_cancellation_failed",SEND_MESSAGE_WITH_ROBOTEXT:"send_message_with_robotext",SEND_MESSAGE_WITH_ATTACHMENT:"send_message_with_attachment",SEND_MESSAGE_WITH_LOG_MESSAGE:"send_message_with_log_message",SEND_MESSAGE_FAILURE:"send_message_failure",SEND_BLOCK_ALL_LOG_MESSAGE_EXCEPTION:"send_block_all_log_message_exception",SEND_UNBLOCK_ALL_LOG_MESSAGE_EXCEPTION:"send_unblock_all_log_message_exception",DIALOG_OPENED:"dialog_opened",DIALOG_CLOSED:"dialog_closed",DIALOG_LOAD_ERROR:"dialog_load_error",DIALOG_LOAD_SUCCESS:"dialog_load_success",NOT_YOU_CLICKED:"not_you_clicked",PRODUCT_SUBSCRIPTION_CLICKED:"product_subscription_clicked",RECEIPTS:"receipts",CANCELLATIONS:"cancellations",SHIPMENTS:"shipments",NOW_IN_STOCK:"nowinstock",NOTIFY_ME:"notifyme",PROMOTIONAL_MESSAGE:"promotionalmessage",RETAIL_CANCELLATIONS:"retailcancellations",RETAIL_RECEIPTS:"retailreceipts",UPDATE_RECEIPTS:"updatereceipts",RETAIL_SHIPMENTS:"retailshipments",RETAIL_UPDATE_RECEIPTS:"retailupdatereceipts",AIRLINE_ITINERARY:"airlineitinerary",AIRLINE_REMINDER:"airlinereminder",AIRLINE_CHECKIN:"airlinecheckin",AIRLINE_UPDATE:"airlineupdate",AIRLINE_BOARDINGPASS:"airlineboardingpass",BILL_PAYMENT_REQUEST:"billpaymentrequest",SIMPLE_LINK_WITH_STATE:"simplelinkwithstate",BUSINESS_MESSAGE:"businessmessage",PROMOTION_CREATION_ATTEMPTED:"promotion_creation_attempted",PROMOTION_ENT_CREATED:"promotion_ent_created",PROMOTION_SCHEDULED:"promotion_scheduled",PROMOTION_KILLED:"promotion_killed",PROMOTION_USER_ATTEMPTED:"promotion_user_attempted",PROMOTION_USER_GK_FAILED:"promotion_user_gk_failed",PROMOTION_USER_GK_PASSED:"promotion_user_gk_passed",PROMOTION_USER_ALREADY_LINKED:"promotion_user_already_linked",PROMOTION_USER_NOT_LINKED:"promotion_user_not_linked",PROMOTION_USER_PREVIOUSLY_UNLINKED:"promotion_user_previously_unlinked",PROMOTION_USER_BLOCKED_PROMOTION:"promotion_user_blocked_promotion",PROMOTION_USER_SEND_MESSAGE_EXCEPTION:"promotion_user_send_message_exception",PROMOTION_ATOMIC_MESSAGE_SENT:"promotion_atomic_message_sent",PROMOTION_LOG_MESSAGE_SENT:"promotion_log_message_sent",PROMOTION_ROBOTEXT_SENT:"promotion_robotext_sent",PROMOTION_ATTACHMENT_SENT:"promotion_attachment_sent",PROMOTION_ASYNC_JOB_ERROR:"promotion_async_job_error",M_SUGGESTION_CALL:"m_suggestion_call",M_SUGGESTION_ENT_CREATED:"m_suggestion_ent_created",M_SUGGESTION_LINK_IF_NECESSARY:"m_suggestion_link_if_necessary",M_SUGGESTION_SEND_MESSAGE:"m_suggestion_send_message",GEN_CANCELLATION_ENT:"gen_cancellation_ent",CANCELLATION_NOTIFICATION_READY:"cancellation_notification_ready",CANCELLATION_NOTIFICATION_SENT:"cancellation_notification_sent",LIVECHAT_HISTORY_USER_FETCH_FAILURE:"livechat_history_user_fetch_failure",LIVECHAT_HISTORY_PAGE_FETCH_FAILURE:"livechat_history_page_fetch_failure",LIVECHAT_HISTORY_API_SUCCESS:"livechat_history_api_success",LIVECHAT_HISTORY_API_FAILURE:"livechat_history_api_failure",PIXEL_FIRE_CALL:"pixel_fire_call",PIXEL_EVENT_NAME_VALIDATED:"pixel_event_name_validated",PIXEL_SECURITY_CHECKED:"pixel_security_checked",PIXEL_MESSAGE_SENT:"pixel_message_sent",PIXEL_EVENT_HANDLER_EXCEPTION:"pixel_event_handler_exception",PIXEL_INVALID_SENDER:"pixel_invalid_sender",PIXEL_MULTIPLE_WELCOME_MESSAGE_NOT_ALLOWED:"pixel_multiple_welcome_message_not_allowed",PIXEL_NO_OPT_IN:"pixel_event_no_opt_in",PROMOTION_CTA_CLICKED:"promotion_cta_clicked"};},null);
__d('AutoPager.react',['DOM','Event','OnVisible','Parent','React','ReactDOM','SubscriptionsHandler','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=l.PropTypes,q=l.createClass({displayName:'AutoPager',propTypes:{className:p.string,onEnterBuffer:p.number.isRequired,onVisible:p.func.isRequired,scrollableAreaClass:p.string},componentDidMount:function(){if(this.props.scrollableAreaClass){this.scrollableArea=k.byClass(m.findDOMNode(this),this.props.scrollableAreaClass);var r=h.find(this.scrollableArea,'.uiScrollableAreaWrap');}else r=window;this.subscriptions=new n();this.subscriptions.addSubscriptions(i.listen(r,'scroll',o(this.onScroll,100)));},componentWillUnmount:function(){this.getViewportListener().remove();this.subscriptions.release();},getViewportListener:function(){if(!this.onEnterViewportListener)this.onEnterViewportListener=new j(m.findDOMNode(this),(function(){return this.props.onVisible();}).bind(this),false,this.props.onEnterBuffer,false,this.scrollableArea);return this.onEnterViewportListener;},onScroll:function(){this.getViewportListener().reset();},render:function(){return l.createElement('div',{className:this.props.className});}});f.exports=q;},null);
__d('ScrollablePhotoViewStateCore',['emptyFunction','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k){'use strict';this.$ScrollablePhotoViewStateCore1=k.photoStore;this.$ScrollablePhotoViewStateCore2=k.viewer;this.$ScrollablePhotoViewStateCore3=k.setToken;this.$ScrollablePhotoViewStateCore4=k.updateCallback;this.$ScrollablePhotoViewStateCore5=k.subscribeUpdatePhotos;this.$ScrollablePhotoViewStateCore6=k.fetchInitData;this.$ScrollablePhotoViewStateCore7=k.initBatchSize;this.$ScrollablePhotoViewStateCore8=k.pageBatchSize;this.$ScrollablePhotoViewStateCore9=new i();}j.prototype.initViewState=function(){'use strict';this.$ScrollablePhotoViewStateCore9.addSubscriptions(this.$ScrollablePhotoViewStateCore5(this.updateData.bind(this)));if(this.$ScrollablePhotoViewStateCore1.hasBeenCreated(this.$ScrollablePhotoViewStateCore3)){var k=this.$ScrollablePhotoViewStateCore1.getAvailableRange(this.$ScrollablePhotoViewStateCore3).length;if(k>=this.$ScrollablePhotoViewStateCore7||!this.$ScrollablePhotoViewStateCore1.hasNextPage(this.$ScrollablePhotoViewStateCore3))this.syncState();return;}this.$ScrollablePhotoViewStateCore6(this.$ScrollablePhotoViewStateCore3);};j.prototype.hasNextPage=function(){'use strict';return (this.$ScrollablePhotoViewStateCore1.hasBeenCreated(this.$ScrollablePhotoViewStateCore3)&&this.$ScrollablePhotoViewStateCore1.hasNextPage(this.$ScrollablePhotoViewStateCore3));};j.prototype.fetchToIndex=function(k){'use strict';var l=this.$ScrollablePhotoViewStateCore1.getEndIndex(this.$ScrollablePhotoViewStateCore3),m=k-l;if(m<=0)return;this.$ScrollablePhotoViewStateCore1.getItemsAfterIndex(this.$ScrollablePhotoViewStateCore3,l,m,h);};j.prototype.fetchMore=function(k){'use strict';if(!this.hasNextPage())return;this.$ScrollablePhotoViewStateCore1.getItemsAfterIndex(this.$ScrollablePhotoViewStateCore3,this.$ScrollablePhotoViewStateCore1.getEndIndex(this.$ScrollablePhotoViewStateCore3),this.$ScrollablePhotoViewStateCore8,k||h);};j.prototype.destroy=function(){'use strict';this.$ScrollablePhotoViewStateCore9.release();};j.prototype.updateData=function(k){'use strict';if(k.set_id!=this.$ScrollablePhotoViewStateCore3)return;var l=k.query_results&&k.query_results.result_type;if(l=='init'){this.$ScrollablePhotoViewStateCore1.executePostCreate(this.$ScrollablePhotoViewStateCore3,(function(){this.syncState();}).bind(this));}else this.syncState();};f.exports=j;},null);
__d('MercuryThreadSnippet.react',['immutable','MercuryAttachmentSnippet.react','MercuryIDs','React','TextWithEmoticons.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=k.PropTypes,p=k.createClass({displayName:'MercuryThreadSnippet',propTypes:{participants:o.instanceOf(h.Map).isRequired,shouldAlwaysRenderSender:o.bool,shouldRenderYou:o.bool,thread:o.object.isRequired,viewer:o.string.isRequired},shouldComponentUpdate:function(s,t){return (this.props.shouldRenderYou!==s.shouldRenderYou||this.props.thread!==s.thread||this.props.viewer!==s.viewer||!h.is(s.participants,this.props.participants));},render:function(){return (k.createElement('span',{className:this.props.className},this._renderAttachmentIndicator(),this._renderSnippet()));},_renderAttachmentIndicator:function(){if(!this.props.thread.snippet||!q(this.props.thread))return null;return (k.createElement('span',{className:"_j0r"}));},_renderSnippet:function(){var s=this.props.thread,t=j.getParticipantIDFromUserID(this.props.viewer),u=this._renderInnerSnippet(),v=s.participants.length;if(s.is_subscribed)v--;if(s.snippet_has_attachment||!s.snippet_sender)return u;if(s.snippet_sender===t){if(!this.props.shouldRenderYou)return u;return n._("You: {conversation_snippet}",[n.param('conversation_snippet',u)]);}if(v<=1&&!this.props.shouldAlwaysRenderSender)return u;var w=this.props.participants.get(s.snippet_sender);if(!w||!w.short_name)return u;var x=w.short_name;if(s){var y=s.custom_nickname?s.custom_nickname:null,z=j.getUserIDFromParticipantID(w.id);if(y&&z&&y[z])x=y[z];}return n._("{name}: {conversation_snippet}",[n.param('name',x),n.param('conversation_snippet',u)]);},_renderInnerSnippet:function(){var s=this.props.thread,t=s.snippet;if(t&&t.startsWith('?OTR'))return n._("[encrypted message]");if(t)return (k.createElement(l,{renderEmoticons:true,renderEmoji:true,text:t.replace(/\r\n|[\r\n]/g,' ')}));if(q(s))return (k.createElement(i,{thread:s,viewer:this.props.viewer}));return null;}});function q(s){return (s.snippet_has_attachment&&s.snippet_attachments&&s.snippet_attachments.length>0);}function r(s){return !s.snippet&&q(s);}f.exports=p;},null);
__d('AsyncUploadQueue',['AsyncUploadBase'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i,j;i=babelHelpers.inherits(k,h);j=i&&i.prototype;function k(l){'use strict';j.constructor.call(this,l);this._pending=[];this._waiting=[];}k.prototype.enqueue=function(l,m,n){'use strict';return this._add(this._waiting.push.bind(this._waiting),l,m,n);};k.prototype.prepend=function(l,m,n){'use strict';return this._add(this._waiting.unshift.bind(this._waiting),l,m,n);};k.prototype._add=function(l,m,n,o){'use strict';var p=babelHelpers._extends({},this._data,o),q=this._createFileUpload(m,n,p);l(q);this._processQueue();return q;};k.prototype.dequeue=function(l){'use strict';this._abort(l);};f.exports=k;},null);
__d('Waiter',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this.$Waiter1=i;this.$Waiter2=0;this.$Waiter3=false;}h.prototype.wait=function(i){'use strict';var j=this,k=false;this.$Waiter4();return function(){if(k)return;for(var l=arguments.length,m=Array(l),n=0;n<l;n++)m[n]=arguments[n];i&&i.apply(this,m);j.$Waiter5();k=true;};};h.prototype.go=function(){'use strict';this.$Waiter3=true;this.$Waiter6();return this;};h.prototype.$Waiter4=function(){'use strict';this.$Waiter2++;};h.prototype.$Waiter6=function(){'use strict';if(!this.$Waiter2&&this.$Waiter3)this.$Waiter1();};h.prototype.$Waiter5=function(){'use strict';this.$Waiter2--;this.$Waiter6();};f.exports=h;},null);
__d('PagesManagerMessagingNUXInboxTour.react',['DOMQuery','NuxTour.react','NuxTourContextualStep.react','React','csx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;'use strict';var p=k.PropTypes,q=321;n=babelHelpers.inherits(r,k.Component);o=n&&n.prototype;function r(s){o.constructor.call(this,s);}r.prototype.$PagesManagerMessagingNUXInboxTour1=function(s,t,u){return {context:h.find(this.props.rootElement,s),focusContext:true,isContextual:true,position:u,render:t};};r.prototype.$PagesManagerMessagingNUXInboxTour2=function(){var s=[null,this.$PagesManagerMessagingNUXInboxTour1("._14vf",this.$PagesManagerMessagingNUXInboxTour3,'right'),this.$PagesManagerMessagingNUXInboxTour1(".__1d",this.$PagesManagerMessagingNUXInboxTour4,'left')];if(this.props.shouldShowContextCardStep)s.push(this.$PagesManagerMessagingNUXInboxTour1("._2utd",this.$PagesManagerMessagingNUXInboxTour5,'left'));return s;};r.prototype.$PagesManagerMessagingNUXInboxTour4=function(){var s=m._("More intuitive responding"),t=m._("Compose messages, share attachments and interact with people from a single, familiar place alongside conversations.");return (k.createElement(j,{showCloseButton:false,title:s},t));};r.prototype.$PagesManagerMessagingNUXInboxTour5=function(){var s=m._("Know more about who you're messaging"),t=m._("To help you have more personalised conversations, we've put all of the basic information about who you're talking to next to the thread.");return (k.createElement(j,{showCloseButton:false,title:s},t));};r.prototype.$PagesManagerMessagingNUXInboxTour3=function(){var s=m._("Single, organised view"),t=m._("We've made managing conversations simpler. You can now flag conversations to follow up later and quickly see the ones that need your attention.");return (k.createElement(j,{showCloseButton:false,title:s},t));};r.prototype.render=function(){return (k.createElement(i,{contextualWidth:q,initialStep:this.props.initialStep||1,onHide:this.props.onHide,onCompleted:this.props.onCompleted,onNotNowClicked:this.props.onNotNow,steps:this.$PagesManagerMessagingNUXInboxTour2(),visible:true}));};r.propTypes={initialStep:p.number,onCompleted:p.func,onHide:p.func.isRequired,onNotNow:p.func,onStepChange:p.func,rootElement:p.object.isRequired};f.exports=r;},null);
__d('PagesManagerMessagingSavedRepliesListItem.react',['ActorURI','AsyncRequest','LeftRight.react','React','SavedResponsesImage.react','SavedResponsesTokensUtils','SavedResponsesUtils','XPagesSavedResponsesImageDuplicationController','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s;'use strict';var t=k.PropTypes,u=53,v=53;r=babelHelpers.inherits(w,k.Component);s=r&&r.prototype;function w(x){s.constructor.call(this,x);this.state={isHovering:false};}w.prototype.$PagesManagerMessagingSavedRepliesListItem1=function(){if(this.props.reply.image){var x=this.props.reply.image.id;return (k.createElement(l,{className:"_3-9b _wba",displayClassName:"_wba",height:u,imageID:x,loadingClassName:"_wba",pageID:this.props.pageID,shouldShowCloseButton:false,width:v}));}};w.prototype.$PagesManagerMessagingSavedRepliesListItem2=function(){if(this.props.reply.title)return (k.createElement('h4',{className:"_wbb"},this.props.reply.title));};w.prototype.$PagesManagerMessagingSavedRepliesListItem3=function(){var x=m.prepareforSend(this.props.reply.message,this.props.tokens),y=null,z,aa;if(!this.props.reply.image){this.props.onClick(x,y);return;}y=this.props.reply.image.id;z=o.getURIBuilder().getURI();aa=h.create(z,this.props.pageID);new i().setURI(aa).setMethod('POST').setData({image_id:y}).setHandler((function(ba){var ca=n.generateImageMetadata(''+ba.payload.duplicatedImageID);this.props.onClick(x,ca);}).bind(this)).send();};w.prototype.$PagesManagerMessagingSavedRepliesListItem4=function(){var x=m.prepareforSend(this.props.reply.message,this.props.tokens);this.props.onMouseEnter(x);};w.prototype.$PagesManagerMessagingSavedRepliesListItem5=function(x){var y=0,z=0,aa=/\{{(.*?)\}}/g,ba=aa.exec(x),ca=0,da=[];while(ba!=null){z=ba.index;da.push(k.createElement('span',{key:'token:'+ca},x.substring(y,z)));y=z+ba[0].length;ca+=1;var ea=ba[1] in this.props.tokens?this.props.tokens[ba[1]].value:ba[1];da.push(k.createElement('span',{className:"_3p6b",key:'token:'+ca},ea));ba=aa.exec(x);ca+=1;}da.push(k.createElement('span',{key:'token:'+ca},x.substring(y,x.length)));ca+=1;return da;};w.prototype.render=function(){return (k.createElement('li',{className:q("_2ph_ _1_2c",this.props.className),onClick:(function(){return this.$PagesManagerMessagingSavedRepliesListItem3();}).bind(this),onMouseEnter:(function(){return this.$PagesManagerMessagingSavedRepliesListItem4();}).bind(this),onMouseLeave:(function(){return this.props.onMouseLeave();}).bind(this),ref:'replyItem'},k.createElement(j,{direction:'right'},k.createElement('div',null,this.$PagesManagerMessagingSavedRepliesListItem2(),this.$PagesManagerMessagingSavedRepliesListItem5(this.props.reply.message)),this.$PagesManagerMessagingSavedRepliesListItem1())));};w.propTypes={className:t.string,onClick:t.func.isRequired,onMouseEnter:t.func.isRequired,onMouseLeave:t.func.isRequired,pageID:t.string.isRequired,reply:t.object.isRequired,tokens:t.object.isRequired};f.exports=w;},null);
__d('fetchInitPhotoViewState',['AsyncRequest'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j,k){new h(j).setData({set:k}).send();}f.exports=i;},null);
__d('subscribeToArbiterUpdatePhotos',['Arbiter'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){return h.subscribe('update-photos',function(k,l){j(l);});}f.exports=i;},null);
__d('DragDropFilePicker',['DragDropTarget','mixin','ArbiterMixin','FilePickerEvent','FileSelectionContainer','createArrayFromMixed','SelectionSource'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o,p;o=babelHelpers.inherits(q,i(j));p=o&&o.prototype;function q(r,s){'use strict';p.constructor.call(this);this.$DragDropFilePicker1=new h(r);if(s.onDocumentDragEnterCallback)this.$DragDropFilePicker1.setOnDocumentDragEnterCallback(s.onDocumentDragEnterCallback);if(s.onDocumentDragLeaveCallback)this.$DragDropFilePicker1.setOnDocumentDragLeaveCallback(s.onDocumentDragLeaveCallback);if(s.onDragEnterCallback)this.$DragDropFilePicker1.setOnDragEnterCallback(s.onDragEnterCallback);if(s.onDragLeaveCallback)this.$DragDropFilePicker1.setOnDragLeaveCallback(s.onDragLeaveCallback);this.$DragDropFilePicker1.setOnFilesDropCallback((function(t){var u=m(t).filter(function(v){return !s.isFileValid||s.isFileValid(v);}).map(function(v){return new l(v);});if(u.length>0){this.inform(k.SELECTED,{sender:this,source:n.FILE,selections:u});}else s.onDocumentDragLeaveCallback.call(null);}).bind(this));this.$DragDropFilePicker1.enable();}q.prototype.disable=function(){'use strict';this.$DragDropFilePicker1.disable();};f.exports=q;},null);
__d('ExistingPhotoSelectionContainer',['BaseSelectionContainer'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i,j;i=babelHelpers.inherits(k,h);j=i&&i.prototype;function k(l,m,n){'use strict';j.constructor.call(this);this.$ExistingPhotoSelectionContainer1=l;this.$ExistingPhotoSelectionContainer2=m;this.$ExistingPhotoSelectionContainer3=n;}k.prototype.getExistingImageID=function(){'use strict';return this.$ExistingPhotoSelectionContainer1;};k.prototype.getSrc=function(){'use strict';return this.$ExistingPhotoSelectionContainer2;};k.prototype.getSource=function(){'use strict';return this.$ExistingPhotoSelectionContainer3;};k.prototype.hasPlaceholderUI=function(){'use strict';return true;};f.exports=k;},null);
__d('ExistingPhotoPicker',['ArbiterMixin','mixin','FilePickerEvent','ExistingPhotoSelectionContainer'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;l=babelHelpers.inherits(n,i(h));m=l&&l.prototype;function n(o){'use strict';m.constructor.call(this);this.$ExistingPhotoPicker1=o;}n.prototype.begin=function(){'use strict';this.inform(j.BEGIN);};n.prototype.select=function(o,p){'use strict';this.inform(j.SELECTED,{sender:this,selections:[new k(o,p,this.$ExistingPhotoPicker1)]});};f.exports=n;},null);
__d('OmnipickerDispatcher',['Dispatcher_DEPRECATED'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();f.exports=new h();},null);
__d('OmnipickerActions',['OmnipickerDispatcher','clamp','keyMirror'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=j({APP_INITIALIZED:null,FILE_PICKER_SELECT_STARTED:null,FILE_PICKER_SELECTED:null,FILE_PICKER_SELECT_CANCELED:null,EXISTING_PHOTOS_FETCHED:null,PANEL_INITIALIZED:null,PHOTO_SELECTED_OPTIMISTICALLY:null,PHOTO_SOURCE_SELECTED:null,RESIZE_FAILED:null,RESIZE_STARTED:null,RESIZE_SUCCEEDED:null,SELECTION_CHANGED:null,UPLOAD_CANCELED:null,UPLOAD_FAILED:null,UPLOAD_FINISHED:null,UPLOAD_PROGRESSED:null,UPLOAD_QUEUED:null,UPLOAD_STARTED:null}),l={types:k,appInitialized:function(m,n,o){h.dispatch({type:k.APP_INITIALIZED,appID:m,logger:n,initialSource:o});},panelInitialized:function(m,n){h.dispatch({type:k.PANEL_INITIALIZED,appID:m,source:n});},photoSourceSelected:function(m,n){h.dispatch({type:k.PHOTO_SOURCE_SELECTED,appID:m,source:n});},filePickerSelectStarted:function(m,n,o){h.dispatch({type:k.FILE_PICKER_SELECT_STARTED,appID:m,method:n,ref:o});},filePickerSelected:function(m,n,o){h.dispatch({type:k.FILE_PICKER_SELECTED,appID:m,method:n,ref:o});},filePickerSelectCancelled:function(m,n,o){h.dispatch({type:k.FILE_PICKER_SELECT_CANCELED,appID:m,method:n,ref:o});},resizeFailed:function(m,n,o,p){h.dispatch({type:k.RESIZE_FAILED,appID:m,dt:n,bytes:o,errorCode:p});},resizeStarted:function(m){h.dispatch({type:k.RESIZE_STARTED,appID:m});},resizeSucceeded:function(m,n,o,p,q){h.dispatch({type:k.RESIZE_SUCCEEDED,appID:m,dt:n,bytes:o,originalSize:p,customTags:q});},uploadQueued:function(m,n,o){h.dispatch({type:k.UPLOAD_QUEUED,appID:m,source:n,ids:o.map(function(p){return p.getSelectionContainerID();}),volume:o.length});},selectionChanged:function(m,n,o,p){h.dispatch({type:k.SELECTION_CHANGED,appID:m,source:n,id:o,checked:p});},uploadStart:function(m,n,o,p){h.dispatch({type:k.UPLOAD_STARTED,appID:m,source:n,id:o,bytes:p});},uploadProgress:function(m,n,o,p){var q=i(p.bytesTransferred/p.file.size*100,0,100);h.dispatch({type:k.UPLOAD_PROGRESSED,appID:m,source:n,id:o,progress:q});},uploadDone:function(m,n,o,p,q,r){h.dispatch({type:k.UPLOAD_FINISHED,appID:m,source:n,id:o,src:p,fbid:q,retriesNeeded:r});},uploadFailed:function(m,n,o,p,q){h.dispatch({type:k.UPLOAD_FAILED,appID:m,source:n,id:o,retriesNeeded:p,errorCode:q});},existingPhotosFetched:function(m,n,o){h.dispatch({type:k.EXISTING_PHOTOS_FETCHED,appID:m,photos:o.map(function(p){return {source:n,id:p.id,src:p.image.uri};})});},optimisticSelect:function(m,n,o){h.dispatch({type:k.PHOTO_SELECTED_OPTIMISTICALLY,appID:m,source:n,id:o});},cancelUpload:function(m,n,o){h.dispatch({type:k.UPLOAD_CANCELED,appID:m,source:n,id:o});}};f.exports=l;},null);
__d('OmnipickerDialogRenderer',['DOM','ReactDOM'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();function j(k){this.$OmnipickerDialogRenderer1=k;this.$OmnipickerDialogRenderer2=k.props.$OmnipickerDialogRenderer2;if(!this.$OmnipickerDialogRenderer2){this.$OmnipickerDialogRenderer2=h.create('div');h.appendContent(document.body,this.$OmnipickerDialogRenderer2);}}j.prototype.show=function(){if(!this.$OmnipickerDialogRenderer2){this.$OmnipickerDialogRenderer2=h.create('div');h.appendContent(document.body,this.$OmnipickerDialogRenderer2);}i.render(this.$OmnipickerDialogRenderer1,this.$OmnipickerDialogRenderer2);};j.prototype.hide=function(){i.unmountComponentAtNode(this.$OmnipickerDialogRenderer2);h.remove(this.$OmnipickerDialogRenderer2);this.$OmnipickerDialogRenderer2=null;};j.prototype.isShowing=function(){return !!this.$OmnipickerDialogRenderer2;};f.exports=j;},null);
__d('OmnipickerUploadController',['OmnipickerActions','SelectionSource'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();function j(){this.$OmnipickerUploadController1={};}j.prototype.registerOmnipicker=function(k){this.$OmnipickerUploadController1[k]={};};j.prototype.registerAdapter=function(k,l,m){this.$OmnipickerUploadController1[k][m]=l;var n=i.toPhotoSourceType(m);l.subscribe('maxReached',function(){});l.subscribe('resize_start',this.$OmnipickerUploadController2.bind(this,k));l.subscribe('resize_done',this.$OmnipickerUploadController3.bind(this,k));l.subscribe('resize_hires_start',function(){});l.subscribe('upload_start',this.$OmnipickerUploadController4.bind(this,k,n));l.subscribe('upload_progress',this.$OmnipickerUploadController5.bind(this,k,n));l.subscribe('upload_done',this.$OmnipickerUploadController6.bind(this,k,n));l.subscribe('upload_failed',this.$OmnipickerUploadController7.bind(this,k,n));l.subscribe('finished',function(){});};j.prototype.uploadSelections=function(k,l,m,n){if(!m.every(function(q){return q.getSource()==l;}))throw "Selections' source must be "+l;var o=this.$OmnipickerUploadController1[k][l],p=i.toPhotoSourceType(l);if(!o){m.forEach(function(q){var r=q.getExistingImageID(),s=q.getSrc();h.uploadDone(k,p,r,s,r,0);});return;}if(!m[0].hasPlaceholderUI())h.uploadQueued(k,p,m);o.uploadSelections(m,n);};j.prototype.cancelUpload=function(k,l,m){h.cancelUpload(k,l,m);};j.prototype.$OmnipickerUploadController2=function(k,event,l){h.resizeStarted(k);};j.prototype.$OmnipickerUploadController3=function(k,event,l){var m=l.scubaData.scuba_ints,n=m.timeResizing||m.dt,o=m.resizedSize;if(l.error){h.resizeFailed(k,n,o,l.error.message);}else h.resizeSucceeded(k,n,o,m.originalSize,{skipped_resizing:l.scubaData.scuba_tags.skippedResizing});};j.prototype.$OmnipickerUploadController4=function(k,l,event,m){h.uploadStart(k,l,m.uploadID,m.size);};j.prototype.$OmnipickerUploadController5=function(k,l,event,m){h.uploadProgress(k,l,m.uploadID,m);};j.prototype.$OmnipickerUploadController6=function(k,l,event,m){h.uploadDone(k,l,m.uploadID,m.response.src,m.response.fbid,m.retriesNeeded);};j.prototype.$OmnipickerUploadController7=function(k,l,event,m){h.uploadFailed(k,l,m.uploadID,m.retriesNeeded,m.response_error);};f.exports=new j();},null);
__d('OmnipickerUploadSession',['FilePickerEvent','OmnipickerActions','OmnipickerUploadController','PhotoSourceTypes','SubscriptionsHandler'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();function m(){this.$OmnipickerUploadSession1={};}m.prototype.registerOmnipicker=function(n){this.$OmnipickerUploadSession1[n]={pickersData:[]};};m.prototype.addPicker=function(n,o,p,q){var r=new l();r.addSubscriptions(o.subscribe(h.SELECT_START,function(s,t){i.filePickerSelectStarted(n,q,p);}),o.subscribe(h.SELECTED,function(s,t){if(t.selections&&t.selections.length>0){i.filePickerSelected(n,q,p);var u=t.selections[0].getSource();j.uploadSelections(n,u,t.selections);}}),o.subscribe(h.SELECT_CANCELED,function(s,t){i.filePickerSelectCancelled(n,q,p);}));this.$OmnipickerUploadSession1[n].pickersData.push({picker:o,subscriptions:r});};m.prototype.removePicker=function(n,o){var p=this.$OmnipickerUploadSession1[n].pickersData;p.forEach(function(q,r){if(q.picker===o){q.subscriptions.release();p.splice(r,1);}});};m.prototype.cancelUpload=function(n,o,p){if(o!==k.COMPUTER)throw 'Can only cancel '+k.COMPUTER+' uploads. '+'Actual source: '+o;j.cancelUpload(n,o,p);};f.exports=new m();},null);
__d('OmnipickerWaterfallLogger',['PhotosUploadWaterfallXMixin','mixin'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j,k;j=babelHelpers.inherits(l,i(h));k=j&&j.prototype;function l(m,n){'use strict';k.constructor.call(this);this.$OmnipickerWaterfallLogger1=m;this.$OmnipickerWaterfallLogger2=n;}l.prototype.getWaterfallAppName=function(){'use strict';return this.$OmnipickerWaterfallLogger1;};l.prototype.getWaterfallID=function(){'use strict';return this.$OmnipickerWaterfallLogger2;};f.exports=l;},null);
__d('OmnipickerLoggerStore',['FluxStore','OmnipickerDispatcher','PUWSteps','invariant','OmnipickerActions'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;'use strict';var n=c('OmnipickerActions').types;l=babelHelpers.inherits(o,h);m=l&&l.prototype;function o(p){m.constructor.call(this,p);this.$OmnipickerLoggerStore1={};}o.prototype.__onDispatch=function(p){if(p.type===n.APP_INITIALIZED){!p.logger?k(0):undefined;this.$OmnipickerLoggerStore1[p.appID]=p.logger;return;}var q=this.$OmnipickerLoggerStore1[p.appID];!q?k(0):undefined;switch(p.type){case n.FILE_PICKER_SELECT_STARTED:case n.FILE_PICKER_SELECTED:case n.FILE_PICKER_SELECT_CANCELED:this.$OmnipickerLoggerStore2(p,q);break;case n.RESIZE_STARTED:q.logStep(j.CLIENT_UPLOAD_BEGIN);q.logStep(j.CLIENT_PROCESS_BEGIN);break;case n.RESIZE_SUCCEEDED:q.logStep(j.CLIENT_PROCESS_SUCCESS,{dt:p.dt,bytes:p.bytes,media_data_size:p.originalSize,custom_tags:p.customTags});break;case n.RESIZE_FAILED:q.logStep(j.CLIENT_PROCESS_FAIL,{dt:p.dt,bytes:p.bytes,error_code:p.errorCode});break;case n.UPLOAD_STARTED:q.logStep(j.CLIENT_TRANSFER_BEGIN,{bytes:p.bytes,ref:p.source});break;case n.UPLOAD_FINISHED:q.logStep(j.CLIENT_TRANSFER_SUCCESS,{auto_retry_count:p.retriesNeeded,ref:p.source});q.logStep(j.CLIENT_UPLOAD_SUCCESS,{fbid:p.fbid,ref:p.source});break;case n.UPLOAD_FAILED:q.logStep(j.CLIENT_UPLOAD_FAIL,{auto_retry_count:p.retriesNeeded,error_code:p.errorCode,ref:p.source});break;case n.UPLOAD_QUEUED:q.logStep(j.CLIENT_TRANSFER_BATCH_BEGIN,{ref:p.source,volume:p.volume});break;default:}};o.prototype.$OmnipickerLoggerStore2=function(p,q){var r;switch(p.type){case n.FILE_PICKER_SELECT_STARTED:r=j.CLIENT_SELECT_BEGIN;break;case n.FILE_PICKER_SELECTED:r=j.CLIENT_SELECT_SUCCESS;break;case n.FILE_PICKER_SELECT_CANCELED:r=j.CLIENT_SELECT_CANCEL;break;default:k(0);}var s=p.method,t=p.ref;q.logStep(r,{method:s,ref:t});};f.exports=new o(i);},null);
__d('OmnipickerPanelList.react',['Image.react','OmnipickerActions','PhotoSourceTypes','React','cx','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=k.PropTypes,o=k.createClass({displayName:'OmnipickerPanelList',propTypes:{appID:n.string.isRequired,photoData:n.object.isRequired,doneSelecting:n.bool.isRequired,selectedSourceType:n.oneOf(Object.keys(j)).isRequired},componentWillMount:function(){k.Children.forEach(this.props.children,(function(p){if(!p)return;var q=this.props.appID;i.panelInitialized(q,p.props.sourceType);}).bind(this));},render:function(){var p=null;if(this.props.doneSelecting)p=k.createElement('div',{className:"_5e8d"},k.createElement('div',{className:"_5e8e"},k.createElement(h,{className:"_5e8o",src:m('/images/photos/omnipicker/mountain_sun.png')})));var q;if(this.props.children.length){q=this.props.children.find((function(r){if(!r)return false;return r.props.sourceType===this.props.selectedSourceType;}).bind(this));}else q=this.props.children;q=k.cloneElement(q,{photoData:this.props.photoData,appID:this.props.appID});return (k.createElement('div',null,p,k.createElement('div',{className:"_5gfy"},q)));}});f.exports=o;},null);
__d('OmnipickerPhotoSourceStore',['FluxStore','OmnipickerDispatcher','OmnipickerActions'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j,k;'use strict';var l=c('OmnipickerActions').types;j=babelHelpers.inherits(m,h);k=j&&j.prototype;function m(n){k.constructor.call(this,n);this.$OmnipickerPhotoSourceStore1={};}m.prototype.__onDispatch=function(n){switch(n.type){case l.APP_INITIALIZED:this.$OmnipickerPhotoSourceStore1[n.appID]={currentSource:n.initialSource};break;case l.PHOTO_SOURCE_SELECTED:this.$OmnipickerPhotoSourceStore1[n.appID].currentSource=n.source;this.__emitChange();break;default:return;}};m.prototype.getCurrentSource=function(n){return this.$OmnipickerPhotoSourceStore1[n].currentSource;};f.exports=new m(i);},null);
__d('OmnipickerPhotoUploadState',['keyMirror'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=h({NOT_STARTED:null,UPLOADING:null,DONE:null,FAILED:null});f.exports=i;},null);
__d('OmnipickerPhotoStore',['FluxStore','OmnipickerDispatcher','OmnipickerPhotoUploadState','invariant','OmnipickerActions'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l,m;'use strict';var n=c('OmnipickerActions').types;l=babelHelpers.inherits(o,h);m=l&&l.prototype;function o(p){m.constructor.call(this,p);this.$OmnipickerPhotoStore1={};}o.prototype.__onDispatch=function(p){!p.appID?k(0):undefined;var q=this.$OmnipickerPhotoStore1[p.appID];if(q){var r=q.deletedPhotos;if(r&&r[p.id])return;}switch(p.type){case n.APP_INITIALIZED:this.$OmnipickerPhotoStore2(p);return;case n.PANEL_INITIALIZED:this.$OmnipickerPhotoStore3(p);return;case n.EXISTING_PHOTOS_FETCHED:this.$OmnipickerPhotoStore4(p);break;case n.PHOTO_SELECTED_OPTIMISTICALLY:this.$OmnipickerPhotoStore5(p);break;case n.SELECTION_CHANGED:this.$OmnipickerPhotoStore6(p);break;case n.UPLOAD_CANCELED:this.$OmnipickerPhotoStore7(p);break;case n.UPLOAD_FAILED:this.$OmnipickerPhotoStore8(p);break;case n.UPLOAD_FINISHED:this.$OmnipickerPhotoStore9(p);break;case n.UPLOAD_PROGRESSED:this.$OmnipickerPhotoStore10(p);break;case n.UPLOAD_QUEUED:this.$OmnipickerPhotoStore11(p);break;case n.UPLOAD_STARTED:this.$OmnipickerPhotoStore12(p);break;default:return;}this.__emitChange();};o.prototype.getState=function(p){var q=this.$OmnipickerPhotoStore1[p];return {numPhotosSelected:this.$OmnipickerPhotoStore13(q).length,photosOptimisticallyUploading:q.photosOptimisticallyUploading,photosWaitingForUpload:q.photosWaitingForUpload,photoData:q.photos};};o.prototype.getSelectedPhotos=function(p){var q=this.$OmnipickerPhotoStore1[p];return this.$OmnipickerPhotoStore13(q,q.uploadOrder).filter(function(r){return r.fbid!=='';});};o.prototype.$OmnipickerPhotoStore13=function(p,q){var r=q||p.photos,s=[];Object.keys(p.photos).forEach((function(t){var u=Array.isArray(r[t])?r[t]:Object.keys(r[t]);u.forEach((function(v){var w=this.$OmnipickerPhotoStore14(p,t,v);if(w.checked)if(w)s.push(w);}).bind(this));}).bind(this));return s;};o.prototype.$OmnipickerPhotoStore14=function(p,q,r){var s=p.photos;!s[q]?k(0):undefined;var t=s[q][r];!t?k(0):undefined;return t;};o.prototype.$OmnipickerPhotoStore15=function(p){this.$OmnipickerPhotoStore16(p,['source','id']);return this.$OmnipickerPhotoStore14(this.$OmnipickerPhotoStore1[p.appID],p.source,p.id);};o.prototype.$OmnipickerPhotoStore17=function(p,q){!p.hasOwnProperty(q)?k(0):undefined;!(p[q]!==undefined&&p[q]!==null)?k(0):undefined;};o.prototype.$OmnipickerPhotoStore16=function(p,q){q.push('appID');q.forEach((function(r){return this.$OmnipickerPhotoStore17(p,r);}).bind(this));};o.prototype.$OmnipickerPhotoStore18=function(p,q,r){var s=p.photos;!s[q]?k(0):undefined;!!s[q][r]?k(0):undefined;p.uploadOrder[q].push(r);return s[q][r]={id:r,checked:false,fbid:'',progress:0,src:'',uploadState:j.NOT_STARTED};};o.prototype.$OmnipickerPhotoStore19=function(p,q){p.photosWaitingForUpload[q.id]=true;};o.prototype.$OmnipickerPhotoStore2=function(p){var q=p.appID;!!this.$OmnipickerPhotoStore1[q]?k(0):undefined;this.$OmnipickerPhotoStore1[q]={deletedPhotos:{},photos:{},photosWaitingForUpload:{},photosOptimisticallyUploading:{},uploadOrder:{}};};o.prototype.$OmnipickerPhotoStore5=function(p){var q=this.$OmnipickerPhotoStore15(p);q.checked=true;var r=this.$OmnipickerPhotoStore1[p.appID];r.photosOptimisticallyUploading[p.id]=true;};o.prototype.$OmnipickerPhotoStore6=function(p){this.$OmnipickerPhotoStore16(p,['checked']);var q=this.$OmnipickerPhotoStore15(p);q.checked=p.checked;};o.prototype.$OmnipickerPhotoStore3=function(p){this.$OmnipickerPhotoStore16(p,['source']);var q=this.$OmnipickerPhotoStore1[p.appID];q.photos[p.source]={};q.uploadOrder[p.source]=[];};o.prototype.$OmnipickerPhotoStore20=function(p,q,r,s){if(s===j.FAILED||p.photosOptimisticallyUploading[r])return;q.checked=true;};o.prototype.$OmnipickerPhotoStore21=function(p,q,r,s){q.uploadState=s;delete p.photosWaitingForUpload[r];delete p.photosOptimisticallyUploading[r];};o.prototype.$OmnipickerPhotoStore22=function(p,q,r){var s=q.id;delete p.photos[r][s];delete p.photosWaitingForUpload[s];delete p.photosOptimisticallyUploading[s];var t=p.uploadOrder[r].indexOf(s);p.uploadOrder[r].splice(t,1);p.deletedPhotos[s]=true;};o.prototype.$OmnipickerPhotoStore4=function(p){this.$OmnipickerPhotoStore17(p,'photos');var q=this.$OmnipickerPhotoStore1[p.appID];p.photos.forEach((function(r){var s=r.source,t=r.id,u=r.src,v=this.$OmnipickerPhotoStore18(q,s,t);v.src=u;}).bind(this));};o.prototype.$OmnipickerPhotoStore7=function(p){var q=this.$OmnipickerPhotoStore15(p);this.$OmnipickerPhotoStore22(this.$OmnipickerPhotoStore1[p.appID],q,p.source);};o.prototype.$OmnipickerPhotoStore8=function(p){var q=this.$OmnipickerPhotoStore1[p.appID];this.$OmnipickerPhotoStore21(q,this.$OmnipickerPhotoStore15(p),p.id,j.FAILED);};o.prototype.$OmnipickerPhotoStore9=function(p){this.$OmnipickerPhotoStore16(p,['src','fbid']);var q=p.appID,r=p.id,s=p.src,t=p.fbid,u=this.$OmnipickerPhotoStore1[q],v=this.$OmnipickerPhotoStore15(p),w=j.DONE;this.$OmnipickerPhotoStore20(u,v,r,w);this.$OmnipickerPhotoStore21(u,v,r,w);v.src=s;v.fbid=t;};o.prototype.$OmnipickerPhotoStore10=function(p){this.$OmnipickerPhotoStore17(p,'progress');var q=this.$OmnipickerPhotoStore15(p);q.progress=100;};o.prototype.$OmnipickerPhotoStore12=function(p){var q=this.$OmnipickerPhotoStore15(p);q.uploadState=j.UPLOADING;};o.prototype.$OmnipickerPhotoStore11=function(p){this.$OmnipickerPhotoStore16(p,['source','ids']);var q=p.source,r=this.$OmnipickerPhotoStore1[p.appID],s=p.ids;s.forEach((function(t){return this.$OmnipickerPhotoStore19(r,this.$OmnipickerPhotoStore18(r,q,t));}).bind(this));};f.exports=new o(i);},null);
__d('Omnipicker.react',['ClientIDs','OmnipickerActions','OmnipickerPanelList.react','OmnipickerPhotoSourceStore','OmnipickerPhotoStore','OmnipickerUploadController','OmnipickerUploadSession','OmnipickerWaterfallLogger','React','SubscriptionsHandler','Waiter','invariant','OmnipickerLoggerStore'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();c('OmnipickerLoggerStore');c('OmnipickerPhotoSourceStore');c('OmnipickerPhotoStore');var t=p.PropTypes,u=p.createClass({displayName:'Omnipicker',propTypes:{doneSelecting:t.bool.isRequired,logger:t.instanceOf(o).isRequired,onDoneSelecting:t.func.isRequired,onPhotosChange:t.func},getDefaultProps:function(){return {doneSelecting:false};},getInitialState:function(){return {numPhotosSelected:0,numPhotosUploading:0,photoData:{}};},componentWillMount:function(){var v='Omnipicker_ID_'+h.getNewClientID();m.registerOmnipicker(v);n.registerOmnipicker(v);var w=[];p.Children.forEach(this.props.children,function(z){if(z.type===j)w.push(p.cloneElement(z,{appID:v}));});!(w.length===1)?s(0):undefined;var x=w[0],y=null;p.Children.forEach(x.props.children,(function(z){if(!z)return;if(!y||z.props.isSelected)y=z.props.sourceType;if(z.type.getAdapter)m.registerAdapter(v,z.type.getAdapter(this.props.logger,z.props.config),z.props.selectionSource);}).bind(this));!!!y?s(0):undefined;this.setState({appID:v,sourceType:y});i.appInitialized(v,this.props.logger,y);},componentDidMount:function(){this._subscriptions=new q();this._subscriptions.addSubscriptions(l.addListener(this.handlePhotosChangeEvent),k.addListener(this.handleSourceChangeEvent));this._onDoneSelectingWaiter=new r((function(){this.props.onDoneSelecting(l.getSelectedPhotos(this.state.appID),this.state.sourceType);}).bind(this));},componentWillUnmount:function(){this._subscriptions.release();},componentDidUpdate:function(){if(this.props.doneSelecting)this._onDoneSelectingWaiter.go();},handlePhotosChangeEvent:function(){var v=l.getState(this.state.appID),w=Object.keys(v.photosWaitingForUpload).length,x=Object.keys(v.photosOptimisticallyUploading).length;if(x>0){if(!this._optimisticLock)this._optimisticLock=this._onDoneSelectingWaiter.wait();}else if(this._optimisticLock){this._optimisticLock.call(this);this._optimisticLock=null;}this.setState({numPhotosSelected:v.numPhotosSelected,numPhotosUploading:w,photoData:v.photoData});this.props.onPhotosChange&&this.props.onPhotosChange(v.numPhotosSelected,w);},handleSourceChangeEvent:function(){this.setState({sourceType:k.getCurrentSource(this.state.appID)});},render:function(){var v=p.Children.map(this.props.children,(function(w){var x={selectedSourceType:this.state.sourceType,appID:this.state.appID};if(w.type===j)Object.assign(x,{photoData:this.state.photoData[this.state.sourceType]||{},doneSelecting:this.props.doneSelecting});return p.cloneElement(w,x);}).bind(this));return p.createElement('div',null,v);}});f.exports=u;},null);
__d('OmnipickerDialog.react',['DOM','Event','Keys','Link.react','OmnipickerConfig','React','ReactLayeredComponentMixin','SubscriptionsHandler','XUICloseButton.react','XUIDialog.react','XUIDialogButton.react','XUIDialogFooter.react','XUIDialogTitle.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=m.PropTypes,x=m.createClass({displayName:'OmnipickerDialog',mixins:[n],propTypes:{onCancel:w.func.isRequired,title:w.string.isRequired},getInitialState:function(){return {doneSelecting:false,numPhotosSelected:0,numPhotosUploading:0,uploadProgress:0};},componentDidMount:function(){this._subscriptions=new o();this._subscriptions.addSubscriptions(i.listen(document,'keydown',this.handleKeyDownEvent));},componentWillUnmount:function(){this._subscriptions.release();},getButtonLabel:function(){var y=this.state.numPhotosSelected;if(y===1)return v._("Use Photo");if(y>1)return v._("Use Photos ({number})",[v.param('number',y)]);return v._("Use Photos");},handleUsePhotos:function(){this.setState({doneSelecting:true});},handleKeyDownEvent:function(event){if(i.getKeyCode(event)===j.ESC)this.props.onCancel();},handlePhotosChange:function(y,z){this.setState({numPhotosSelected:y,numPhotosUploading:z});},renderLayers:function(){var y=this.state.doneSelecting||this.state.numPhotosSelected<1||this.state.numPhotosUploading>0,z=null;if(l.FEEDBACK_GROUP_PATH)z=m.createElement('div',{className:"_2srv"},m.createElement(k,{href:l.FEEDBACK_GROUP_PATH,target:'_blank'},'Omnipicker Feedback Group'));var aa=m.Children.only(this.props.children);aa=m.cloneElement(aa,{onPhotosChange:this.handlePhotosChange,doneSelecting:this.state.doneSelecting});return {dialog:m.createElement(q,{shown:true,layerHideOnBlur:false,width:l.DIALOG_WIDTH},m.createElement(t,{showCloseButton:false},m.createElement('span',null,this.props.title),m.createElement(p,{className:"_51-t",label:v._("Close"),onClick:this.props.onCancel})),aa,m.createElement('div',{className:"_3bnc"},m.createElement(s,{className:"_3bnd",leftContent:z},m.createElement(r,{action:'button',label:v._("Cancel"),onClick:this.props.onCancel,size:'xlarge'}),m.createElement(r,{className:"_3bne",use:'confirm',action:'confirm',size:'xlarge',disabled:y,label:this.getButtonLabel(),onClick:this.handleUsePhotos}))))};},render:function(){return m.createElement('div',null);}});f.exports=x;},null);
__d('OmnipickerPanelMixin.react',['PhotoSourceTypes','React'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=i.PropTypes,k={propTypes:{appID:j.string.isRequired,photoData:j.object.isRequired,sourceType:j.oneOf(Object.keys(h)).isRequired,selectionSource:j.string.isRequired}};f.exports=k;},null);
__d('OmnipickerPhoto.react',['Event','OmnipickerActions','OmnipickerPhotoUploadState','OmnipickerUploadSession','PhotoSourceTypes','ProgressBar.react','React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();var q=n.PropTypes,r=20000,s=n.createClass({displayName:'OmnipickerPhoto',propTypes:{appID:q.string.isRequired,checked:q.bool,id:q.string.isRequired,onPhotoSelected:q.func,photoSourceType:q.oneOf(Object.keys(l)).isRequired,progress:q.number,showUploadProgress:q.bool,src:q.string,supportsCancel:q.bool,uploadState:q.oneOf([j.NOT_STARTED,j.UPLOADING,j.DONE,j.FAILED]).isRequired},getDefaultProps:function(){return {checked:false,progress:0,showUploadProgress:true,supportsCancel:false};},getInitialState:function(){return {canCancel:false};},componentDidMount:function(){if(this.props.supportsCancel&&this.props.uploadState===j.UPLOADING)this.setCancelTimeout();},componentWillReceiveProps:function(t){if(this.props.supportsCancel){var u=this.props.uploadState!==t.uploadState||this.props.progress!==t.progress;if(u){this.clearCancelTimeout();if(t.uploadState===j.UPLOADING)this.setCancelTimeout();}}},componentWillUnmount:function(){this.clearCancelTimeout();},render:function(){return (n.createElement('div',{className:"_47pv",onDragStart:this.onDragStart,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},this.getImage(),this.getSelection(),this.getCancelOverlay(),this.getFailedOverlay(),this.getProgressBar()));},onDragStart:function(event){h.kill(event);},onMouseDown:function(){},onMouseUp:function(){var t=true;if(!this.props.checked&&this.props.onPhotoSelected)t=this.props.onPhotoSelected.call(null,this.props.id);if(t)i.selectionChanged(this.props.appID,this.props.photoSourceType,this.props.id,!this.props.checked);},getImage:function(){if(!this.props.src)return null;return (n.createElement('img',{src:this.props.src,className:"_2dh3"}));},getSelection:function(){if(!this.props.checked)return null;return n.createElement('div',{className:"_2dh3 _1cyy"});},getCancelOverlay:function(){if(this.props.uploadState!==j.UPLOADING||!this.state.canCancel)return null;return (n.createElement('div',{className:"_5goe"},n.createElement('div',{className:"_5gof _1cu0",onClick:this.onCancel},p._("Cancel Upload"))));},getFailedOverlay:function(){if(this.props.uploadState!==j.FAILED)return null;return (n.createElement('div',{className:"_5goe"},n.createElement('div',{className:"_5gof"},p._("Upload Failed"))));},getProgressBar:function(){if(!this.props.showUploadProgress||this.props.uploadState!==j.UPLOADING)return null;var t=null;if(this.props.progress<100){t=n.createElement(m,{value:this.props.progress,min:0,max:100});}else t=n.createElement('div',{className:"_1t2c"});return (n.createElement('div',{className:"_1cyx"},t));},onCancel:function(){k.cancelUpload(this.props.appID,this.props.photoSourceType,this.props.id);},setCancelTimeout:function(){this.cancelTimeout=setTimeout((function(){this.setState({canCancel:true});}).bind(this),r);},clearCancelTimeout:function(){if(this.cancelTimeout){clearTimeout(this.cancelTimeout);this.cancelTimeout=null;}}});f.exports=s;},null);
__d('OmnipickerPhotoGrid.react',['AutoPager.react','OmnipickerPhoto.react','PhotoSourceTypes','React','cx'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=k.PropTypes,n=300,o=k.createClass({displayName:'OmnipickerPhotoGrid',propTypes:{appID:m.string.isRequired,onPhotoSelected:m.func,onScrollPositionThresholdReached:m.func,photos:m.object.isRequired,photoSourceType:m.oneOf(Object.keys(j)).isRequired,showUploadProgress:m.bool,supportsCancel:m.bool},getDefaultProps:function(){return {showUploadProgress:true,supportsCancel:false};},render:function(){return (k.createElement('div',{className:"_xhf"},k.createElement('div',{className:"uiScrollableAreaWrap _1-nf"},this.getPhotos(),this.getAutoPager())));},getPhotos:function(){return Object.keys(this.props.photos).map((function(p){var q=this.props.photos[p];return (k.createElement(i,{appID:this.props.appID,checked:q.checked,id:q.id,key:q.id,onPhotoSelected:this.props.onPhotoSelected,photoSourceType:this.props.photoSourceType,progress:q.progress,showUploadProgress:this.props.showUploadProgress,src:q.src,supportsCancel:this.props.supportsCancel,uploadState:q.uploadState}));}).bind(this));},getAutoPager:function(){if(!this.props.onScrollPositionThresholdReached)return null;return (k.createElement(h,{className:"_4qgs",onEnterBuffer:n,onVisible:this.props.onScrollPositionThresholdReached,scrollableAreaClass:"_xhf"}));}});f.exports=o;},null);
__d('OmnipickerExistingPhotosPanelMixin.react',['ExistingPhotoPicker','OmnipickerActions','OmnipickerPanelMixin.react','OmnipickerPhotoGrid.react','OmnipickerUploadSession','PhotoStore','React','cx','invariant'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();var q=n.PropTypes,r={mixins:[j],propTypes:{initBatchSize:q.number,pageBatchSize:q.number,puwMethod:q.string.isRequired,setID:q.string.isRequired},componentWillMount:function(){!(typeof this.getViewState==='function')?p(0):undefined;this.picker=new h(this.props.selectionSource);l.addPicker(this.props.appID,this.picker,this.props.sourceType,this.props.puwMethod);},componentDidMount:function(){this.getViewState().initViewState();this.picker.begin();},componentWillUnmount:function(){this.getViewState().destroy();l.removePicker(this.props.appID,this.picker);},render:function(){return (n.createElement('div',null,this.getThrobber(),this.getPhotoGrid()));},onViewStateChanged:function(s){i.existingPhotosFetched(this.props.appID,this.props.sourceType,s.media.filter((function(t){return !this.props.photoData[t.id];}).bind(this)));},onPhotoSelected:function(s){this.picker.select(s,this.props.photoData[s].src);return false;},getPhotoGrid:function(){if(!m.hasBeenCreated(this.props.setID))return null;var s=null;if(!m.hasBeenCreated(this.props.setID)||m.hasNextPage(this.props.setID))s=(function(){this.getViewState().fetchMore();}).bind(this);return (n.createElement(k,{appID:this.props.appID,onPhotoSelected:this.onPhotoSelected,onScrollPositionThresholdReached:s,photos:this.props.photoData,photoSourceType:this.props.sourceType,showUploadProgress:false}));},getThrobber:function(){if(m.hasBeenCreated(this.props.setID))return null;return n.createElement('div',{className:"_j0-"});}};f.exports=r;},null);
__d('OmnipickerExistingPhotosViewState',['PhotoStore','ScrollablePhotoViewStateCore','URI','subscribeToArbiterUpdatePhotos','fetchInitPhotoViewState'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;function o(q,r){l(q,r);}m=babelHelpers.inherits(p,i);n=m&&m.prototype;function p(q,r,s,t,u,v){'use strict';n.constructor.call(this,{fetchInitData:o.bind(null,u),initBatchSize:s,pageBatchSize:t,photoStore:h,setToken:r,subscribeUpdatePhotos:k,updateCallback:v,viewer:q});this.$OmnipickerExistingPhotosViewState1=s;this.$OmnipickerExistingPhotosViewState2=r;this.$OmnipickerExistingPhotosViewState3=v;}p.prototype.syncState=function(){'use strict';this.$OmnipickerExistingPhotosViewState3({media:h.getItemsInAvailableRange(this.$OmnipickerExistingPhotosViewState2),hasNextPage:h.hasNextPage(this.$OmnipickerExistingPhotosViewState2)});};f.exports=p;},null);
__d('OmnipickerSelector.react',['OmnipickerActions','PhotoSourceTypes','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=j.PropTypes,n=j.createClass({displayName:'OmnipickerSelector',propTypes:{appID:m.string.isRequired,iconClass:m.string.isRequired,isSelected:m.bool.isRequired,sourceType:m.oneOf(Object.keys(i)).isRequired},onClick:function(){h.photoSourceSelected(this.props.appID,this.props.sourceType);},render:function(){return (j.createElement('li',{className:"_1ys7"},j.createElement('div',{className:"_1ys8"+(this.props.isSelected?' '+"selected":''),onClick:this.onClick},j.createElement('div',{className:"_1ys9"},j.createElement('span',{className:l("_1ysb",this.props.iconClass)}),j.createElement('span',{className:"_1ysc"},this.props.children)))));}});f.exports=n;},null);
__d('OmnipickerSelectorList.react',['PhotoSourceTypes','React','cx'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=i.PropTypes,l=i.createClass({displayName:'OmnipickerSelectorList',propTypes:{appID:k.string.isRequired,selectedSourceType:k.oneOf(Object.keys(h)).isRequired},render:function(){var m=i.Children.map(this.props.children,(function(n){if(!n)return;return i.cloneElement(n,{isSelected:n.props.sourceType===this.props.selectedSourceType,appID:this.props.appID});}).bind(this));return (i.createElement('div',{className:"_1n6_"},i.createElement('ul',null,m)));}});f.exports=l;},null);
__d('ComputerPanelActionState',['keyMirror'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=h({NEUTRAL:null,DROP:null});f.exports=i;},null);
__d('OmnipickerHTML5FilePickerFactory',['HTML5FilePicker','PUWApplications','PUWMethods','PUWUploaders','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m={create:function(n){return new h(n,{accept:'image/*',fallbackFunction:function(){},multiple:true,qn:'todo',waterfallApp:i.WEB_OMNIPICKER,waterfallUploader:k.HTML5,waterfallMethod:j.FILE_SELECTOR,title:l._("Choose files to upload")});}};f.exports=m;},null);
__d('HTML5FilePickerButton.react',['OmnipickerHTML5FilePickerFactory','OmnipickerUploadSession','React','ReactDOM','PhotoSourceTypes','PUWMethods','XUIButton.react','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=j.PropTypes,q=j.createClass({displayName:'HTML5FilePickerButton',propTypes:{appID:p.string.isRequired},componentDidMount:function(){this.picker=h.create(k.findDOMNode(this.refs.fileButton));i.addPicker(this.props.appID,this.picker,l.COMPUTER,m.FILE_SELECTOR);},componentWillUnmount:function(){i.removePicker(this.props.appID,this.picker);},render:function(){var r=o._("Select Files");return (j.createElement(n,{ref:'fileButton',href:'#',size:'xlarge',label:r}));}});f.exports=q;},null);
__d('DragDropInstructions.react',['ComputerPanelActionState','HTML5FilePickerButton.react','React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=j.PropTypes,n=j.createClass({displayName:'DragDropInstructions',propTypes:{actionState:m.oneOf(Object.keys(h)).isRequired,appID:m.string.isRequired,isOverlay:m.bool},renderInstructions:function(){switch(this.props.actionState){case h.DROP:return (j.createElement('div',null,j.createElement('div',{className:"_39ld"},j.createElement('div',{className:"_4zwj"})),j.createElement('div',{className:"_4zwc"},l._("Drop photos here"))));case h.NEUTRAL:return (j.createElement('div',null,j.createElement('div',null,j.createElement('div',{className:"_39ld"},j.createElement('div',{className:"_4zwd"})),j.createElement('div',{className:"_4zwc"},l._("Drag photos here"))),j.createElement('div',{className:"_4zwi"},j.createElement('span',{className:"_4zwe"}),l._("or"),j.createElement('span',{className:"_4zwe"})),j.createElement('div',{className:"_4zwf"},j.createElement(i,{appID:this.props.appID}))));}},renderOverlay:function(){return (j.createElement('div',{className:"_4zwg"},j.createElement('div',{className:"_4zwh"},this.renderInstructions())));},render:function(){if(this.props.isOverlay)return this.renderOverlay();return this.renderInstructions();}});f.exports=n;},null);
__d('EmptyPanel.react',['DragDropInstructions.react','React','ComputerPanelActionState','cx'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=i.PropTypes,m=i.createClass({displayName:'EmptyPanel',propTypes:{actionState:l.oneOf(Object.keys(j)).isRequired,appID:l.string.isRequired},render:function(){var n="_2gyt"+(this.props.actionState===j.NEUTRAL?' '+"_2gyu":'')+(this.props.actionState===j.DROP?' '+"_2gyw":'');return (i.createElement('div',{className:n},i.createElement('div',{className:"_2gyv"},i.createElement(h,{actionState:this.props.actionState,appID:this.props.appID}))));}});f.exports=m;},null);
__d('HTML5UploadAdapter',['AsyncUploadQueue','ArbiterMixin','PhotosUploadWaterfall','PhotosUploadWaterfallMixin','PhotosMimeType','JpegResizer','performanceNow','URI'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();function o(p){this._config=babelHelpers._extends({maxRetries:0,retryTimeout:250,uri:null,qn:null,postParams:{}},p);this._uploads={};this._numProcessing=0;this._activeUploadCount=0;this._uploadQueue=new h(this._config.uri);this._uploadQueue.setAllowCrossOrigin(true);this._uploadQueue.setLimit(p.maxParallel);this._uploadQueue.subscribe('start',this._handleStart.bind(this));this._uploadQueue.subscribe('failure',this._handleFailure.bind(this));this._uploadQueue.subscribe('success',this._handleSuccess.bind(this));this._uploadQueue.subscribe('progress',this._handleProgress.bind(this));this._uploadQueue.subscribe('success_after_abort',this._handleCanceledPhotoUploadedAnyway.bind(this));this._jpegResizer=new m(p.maxParallel);if(p.hasOwnProperty('useHighQuality'))this._jpegResizer.setHighQuality(p.useHighQuality);this._uploadQueue.setPreprocessHandler(this._resizeUpload.bind(this));}Object.assign(o,{isSupported:function(){return h.isSupported()&&m.isSupported();},MAX_WIDTH:2048,MAX_HEIGHT:2048});Object.assign(o.prototype,i,k,{getUploaderApp:function(){return j.APP_HTML5;},getWaterfallID:function(){return this._config.qn;},getWaterfallSource:function(){return this._config.ref;},uploadFiles:function(p,q){p.forEach((function(r){this._enqueueUpload(r,babelHelpers._extends({},this._config.postParams,q));}).bind(this));},uploadSelections:function(p,q){var r=p.map(function(s){var t=s.getFile();t.uploadID=s.getSelectionContainerID();return t;});this.uploadFiles(r,q);},setHiRes:function(p){if(this._config.hasOwnProperty('useHighQuality'))this._jpegResizer.setHighQuality(p);},setNumSelected:function(p){},markDeleted:function(p){},addPostParam:function(p,q){this._config.postParams=this._config.postParams||{};this._config.postParams[p]=q;},cancelIndividualUpload:function(p){var q=this._getUpload(p);if(q){this._uploadQueue.dequeue(q);this._removeUpload(q);}},cancelAllUploads:function(){for(var p in this._uploads){var q=this._getUpload(p);this._uploadQueue.dequeue(q);this._removeUpload(q);}},getActiveUploadCount:function(){return this._activeUploadCount;},_getUpload:function(p){if(p&&this._uploads[p]){return this._uploads[p];}else return null;},_removeUpload:function(p){if(!this._uploads[p.getFile().uploadID])return;delete this._uploads[p.getFile().uploadID];if(!p.isWaiting())this._activeUploadCount--;},_handleStart:function(p,q){this._activeUploadCount++;this.inform('upload_start',{uploadID:q.getFile().uploadID,retry:!!q.getFile()._retryCount,file:q.getFile(),size:q.getFile().size});},_handleFailure:function(p,q){var r=Math.pow(2,q.getFile()._retryCount);this._removeUpload(q);if(q.getFile()._retryCount++<this._config.maxRetries){setTimeout(this._enqueueUpload.bind(this,q.getFile(),babelHelpers._extends({},this._config.postParams,{retry:q.getFile()._retryCount})),this._config.retryTimeout*r);this.logWaterfallStep(j.RETRY_UPLOAD,{code:q.getResponse().getError()});this.inform('upload_retry',{uploadID:q.getFile().uploadID,file:q.getFile(),response:q.getResponse(),retry:q.getFile()._retryCount});}else this.inform('upload_failed',{uploadID:q.getFile().uploadID,file:q.getFile(),response:q.getResponse()});return false;},_handleSuccess:function(p,q){this._removeUpload(q);var r=q.getResponse(),s=r.payload;if(s.metadata)s=s.metadata;this.inform('upload_done',{uploadID:q.getFile().uploadID,response:s[0],hiRes:true,retriesNeeded:q.getFile()._retryCount});},_handleProgress:function(p,q){this.inform('upload_progress',{file:q.getFile(),uploadID:q.getFile().uploadID,bytesTransferred:q.getProgressEvent().loaded});},_resizeUpload:function(p,q){var r=p.getFile();if(!l(r.type).isJpeg())return q(p);this.inform('resize_start',{uploadID:r.uploadID});var s=n();this._jpegResizer.resizeBlob(r,(function(t,u,v){if(t)this.logWaterfallStep(j.CLIENT_ERROR,{code:j.CERROR_RESIZING_FAILED,meta:{message:t.message}});var w=t||v;this.inform('resize_done',{uploadID:r.uploadID,scubaData:{scuba_tags:{skippedResizing:+w},scuba_ints:{timeResizing:n()-s,originalSize:r.size,resizedSize:u&&u.size}},error:t});if(!w){u.uploadID=r.uploadID;u.name=r.name;p.setFile(u);}q(p);}).bind(this));},_handleCanceledPhotoUploadedAnyway:function(p,q){this.inform('canceled_photo_uploaded',q.payload[0].fbid);},_enqueueUpload:function(p,q){q=babelHelpers._extends({},q,{uploader:'html5'});p._retryCount=p._retryCount||0;this._uploads[p.uploadID]=p._retryCount?this._uploadQueue.prepend(p.fileName,p,q):this._uploadQueue.enqueue(p.fileName,p,q);}});f.exports=o;},null);
__d('PhotoPanel.react',['ComputerPanelActionState','DragDropInstructions.react','HTML5FilePickerButton.react','OmnipickerPhotoGrid.react','PhotoSourceTypes','React','ReactDOM','Scroll','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=m.PropTypes,s=m.createClass({displayName:'PhotoPanel',propTypes:{actionState:r.oneOf(Object.keys(h)).isRequired,appID:r.string.isRequired,photoData:r.object.isRequired},getInitialState:function(){return {photoCount:0};},componentWillReceiveProps:function(t){var u=Object.keys(t.photoData).length;this.setState({photoCount:u});},componentDidUpdate:function(t,u){if(this.state.photoCount>u.photoCount){var v=n.findDOMNode(this.refs.pickerBox);o.setTop(v,v.scrollHeight);}},renderInstructions:function(){return (m.createElement('div',{className:"_1-nd"},m.createElement('div',null,m.createElement('div',{className:"_4zwc"},q._("Drag more photos"))),m.createElement('div',{className:"_4zwi"},m.createElement('span',{className:"_4zwe"}),q._("or"),m.createElement('span',{className:"_4zwe"})),m.createElement('div',{className:"_4zwf"},m.createElement(j,{appID:this.props.appID}))));},renderDragAndDropInstructions:function(){if(this.props.actionState!==h.NEUTRAL)return (m.createElement(i,{actionState:this.props.actionState,appID:this.props.appID,isOverlay:true}));},renderPhotoGrid:function(){return (m.createElement(k,{appID:this.props.appID,photos:this.props.photoData,photoSourceType:l.COMPUTER,supportsCancel:true}));},render:function(){return (m.createElement('div',null,m.createElement('div',{className:"_1x-l"},m.createElement('div',{className:"_1-ne _1-nf",ref:'pickerBox'},this.renderPhotoGrid(),this.renderInstructions())),this.renderDragAndDropInstructions()));}});f.exports=s;},null);
__d('ComputerPanel.react',['ComputerPanelActionState','DragDropFilePicker','EmptyPanel.react','FilePickerEvent','HTML5UploadAdapter','React','OmnipickerConfig','OmnipickerPanelMixin.react','OmnipickerUploadSession','PhotosMimeType','PhotoPanel.react','PhotoSourceTypes','PUWMethods','PUWUploaders','SelectionSource'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){if(c.__markCompiled)c.__markCompiled();var w=m.createClass({displayName:'ComputerPanel',mixins:[o],statics:{getAdapter:function(x,y){var z=n.FILE_UPLOAD_URI;if(y&&y.fileUploadURI)z=y.fileUploadURI;return new l({uri:z,maxRetries:n.HTML5_UPLOADER_MAX_RETRIES,maxParallel:n.HTML5_UPLOADER_MAX_PARALLEL,postParams:{},qn:x.getWaterfallID(),waterfallApp:x.getWaterfallAppName(),waterfallUploader:u.HTML5});}},getDefaultProps:function(){return {selectionSource:v.FILE,sourceType:s.COMPUTER};},getInitialState:function(){return {actionState:h.NEUTRAL};},componentDidMount:function(){this.picker=new i(document.documentElement,{onDocumentDragEnterCallback:(function(){this.setState({actionState:h.DROP});}).bind(this),onDocumentDragLeaveCallback:(function(){this.setState({actionState:h.NEUTRAL});}).bind(this),isFileValid:function(x){return new q(x.type).isImage();}});p.addPicker(this.props.appID,this.picker,s.COMPUTER,t.DRAGDROP);this.picker.subscribe(k.SELECTED,this.onFilesDropped);},componentWillUnmount:function(){this.picker.disable();p.removePicker(this.props.appID,this.picker);},onFilesDropped:function(x){this.setState({actionState:h.NEUTRAL});},renderEmptyPanel:function(){return (m.createElement(j,{actionState:this.state.actionState,appID:this.props.appID}));},renderPhotoPanel:function(){return (m.createElement(r,{actionState:this.state.actionState,appID:this.props.appID,photoData:this.props.photoData}));},render:function(){var x=Object.keys(this.props.photoData).length,y=x===0?this.renderEmptyPanel():this.renderPhotoPanel();return m.createElement('div',null,y);}});f.exports=w;},null);
__d("XPagesManagerPostedPhotosController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pages\/content_tab\/posted_photos\/",{set:{type:"String",required:true},size:{type:"Int",required:true}});},null);
__d('OmnipickerPagePostedPhotosPanel.react',['ActorURI','OmnipickerConfig','OmnipickerExistingPhotosPanelMixin.react','OmnipickerExistingPhotosViewState','PhotoSourceTypes','PUWMethods','React','SelectionSource','XPagesManagerPostedPhotosController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();var q=n.PropTypes,r=n.createClass({displayName:'OmnipickerPagePostedPhotosPanel',mixins:[j],_viewState:null,propTypes:{pageID:q.string.isRequired},getDefaultProps:function(){return {initBatchSize:20,pageBatchSize:16,puwMethod:m.RECENT_PHOTOS,selectionSource:o.PAGES_POSTED_PHOTOS,setID:i.POSTED_PHOTOS_SET_ID,sourceType:l.PAGES_POSTED_PHOTOS};},componentWillMount:function(){var s=h.create(p.getURIBuilder().setString('set',this.props.setID).setInt('size',this.props.initBatchSize).getURI(),this.props.pageID);this._viewState=new k(this,this.props.setID,this.props.initBatchSize,this.props.pageBatchSize,s,this.onViewStateChanged);},getViewState:function(){return this._viewState;}});f.exports=r;},null);
__d('OmnipickerComputerSelector.react',['OmnipickerSelector.react','PhotoSourceTypes','React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=j.PropTypes,n=j.createClass({displayName:'OmnipickerComputerSelector',propTypes:{labelText:m.string},getDefaultProps:function(){return {sourceType:i.COMPUTER,labelText:l._("Computer")};},render:function(){return (j.createElement(h,babelHelpers._extends({iconClass:"_5o68"},this.props),this.props.labelText));}});f.exports=n;},null);
__d('OmnipickerPagePostedPhotosSelector.react',['OmnipickerSelector.react','PhotoSourceTypes','React','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=j.PropTypes,n=j.createClass({displayName:'OmnipickerPagePostedPhotosSelector',propTypes:{labelText:m.string},getDefaultProps:function(){return {sourceType:i.PAGES_POSTED_PHOTOS,labelText:l._("Page Photos")};},render:function(){return (j.createElement(h,babelHelpers._extends({iconClass:"_2_y4"},this.props),this.props.labelText));}});f.exports=n;},null);