/*!CK:3708258011!*//*1451081291,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["R94sC"]); }

__d('ChatContentSearchButton.react',['BanzaiLogger','ChatContentSearchFlyout.react','ContentSearchEvents','ChatContentSearchContextualDialog.react','Link.react','ReactComponentWithPureRenderMixin','React','ReactLayeredComponentMixin','MercuryShareAttachmentRenderLocations','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){'use strict';if(c.__markCompiled)c.__markCompiled();var t=n.PropTypes,u=n.createClass({displayName:'ChatContentSearchButton',_clickGuard:false,mixins:[m,o],propTypes:{ContextualDialogClass:t.func,flyoutAlignment:t.oneOf(['left','right']),getInput:t.func.isRequired,getQuery:t.func.isRequired,location:t.oneOf(p.getValues()),onLoad:t.func,onSelect:t.func.isRequired},getDefaultProps:function(){return {flyoutAlignment:'left',location:p.CHAT};},getInitialState:function(){return {query:'',shown:false};},componentDidMount:function(){this.props.onLoad&&this.props.onLoad(this);},updateQuery:function(){this.setState({query:this.props.getQuery()});},hideFlyout:function(){this.setState(this.getInitialState());},render:function(){return (n.createElement(l,{className:s(this.props.className,this.state.shown?"open":''),onMouseDown:this._handleMouseDown,onClick:this._handleClick,title:r._("Choose a gif or sticker"),ref:'link'}));},renderLayers:function(){if(!this.state.shown)return {contextualDialog:null};var v=this.props.ContextualDialogClass||k;return {contextualDialog:n.createElement(v,{alignment:this.props.flyoutAlignment,contextRef:(function(){return this.refs.link;}).bind(this),onBlur:this.hideFlyout,onToggle:this._handleContextualDialogToggle,shown:this.state.shown,width:278},n.createElement(i,{location:this.props.location,onEscKeyDown:this.hideFlyout,onResultsLoaded:this._handleResultsLoaded,onSelect:this._handleSelect,query:this.state.query}))};},_handleMouseDown:function(v){this._clickGuard=this.state.shown;},_handleClick:function(v){if(this.state.shown||this._clickGuard)return;v.stopPropagation();this.setState({query:this.props.getQuery(),shown:!this.state.shown});h.log('ContentSearchLoggerConfig',{event:j.OPEN_TRAY,query:this.state.query});},_handleSelect:function(v,w){this.props.onSelect(v,w);this.setState(this.getInitialState());h.log('ContentSearchLoggerConfig',{event:j.RESULT_SENT,query:this.state.query,resultid:v.resultID});},_handleContextualDialogToggle:function(v){this.setState({shown:v});},_handleResultsLoaded:function(v){h.log('ContentSearchLoggerConfig',{event:j.QUERY_RESULTS_LOADED,query:this.state.query,inflighttime:v});}});f.exports=u;},null);