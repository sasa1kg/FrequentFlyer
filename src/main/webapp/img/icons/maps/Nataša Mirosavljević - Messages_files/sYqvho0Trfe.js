/*!CK:3349369793!*//*1451895135,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["kHDa4"]); }

__d("TagExpansionButtonConfig",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={FRIENDS_OF_TAGGED:"friends_of_tagged",TAGGED_ONLY:"tagged_only"};},null);
__d('KeyboardShortcuts',['KeyEventController','Layer','ModalLayer'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();function k(m,n,o){'use strict';this.key=m;this.handler=n;this.filter=o;this.register();}k.prototype.register=function(){'use strict';this.token=h.registerKey(this.key,this.handler,this.filter);};k.prototype.remove=function(){'use strict';this.token.remove();};var l={_tokens:[[]],register:function(m,n,o){o=o||{};var p=o.allowDefault?n:function(event,t){n.apply(this,arguments);event.prevent();},q=o.baseFilters||[h.defaultFilter],r=function(event,t){for(var u=0,v=q.length;u<v;u++)if(!q[u](event,t))return false;return !o.filter||o.filter(event,t);},s=new k(m,p,r);this._tokens[this._tokens.length-1].push(s);return s;},init:function(){i.subscribe('show',(function(m,n){if(n.hasBehavior(j))this.pushLayer();}).bind(this));i.subscribe('hide',(function(m,n){if(n.hasBehavior(j))this.popLayer();}).bind(this));},pushLayer:function(){var m=this._tokens[this._tokens.length-1];m&&m.forEach(function(n){n.remove();});this._tokens.push([]);},popLayer:function(){var m=this._tokens.length-1;if(m<0)return;var n=this._tokens[m];n.forEach(function(p){p.remove();});this._tokens.pop();var o=this._tokens[m-1];o&&o.forEach(function(p){p.register();});}};l.init();f.exports=l;},null);
__d('FeedBaseKeyboardController',['AccessibilityLogger','Arbiter','AsyncDialog','AsyncRequest','Banzai','BanzaiODS','BanzaiNectar','CSS','DOM','DOMScroll','Event','Focus','KeyboardShortcuts','LikeConfirmer','NavigationMessage','Parent','ReactComposerEvents','ReactComposerIDGenerator','Run','Scroll','SubscriptionsHandler','UITinyViewportAction','Vector','ViewportBounds','csx','emptyFunction','ge','getActiveElement','isAsyncScrollQuery','isElementNode','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la){if(c.__markCompiled)c.__markCompiled();var ma=0;function na(){var pa=ha('pagelet_bluebar');ma=!ca.isTiny()&&pa?pa.offsetTop+pa.offsetHeight:0;}function oa(pa){'use strict';this.root=pa;this.init();}oa.prototype.getStories=function(){'use strict';};oa.prototype.getParentStory=function(pa){'use strict';};oa.prototype.isStory=function(pa){'use strict';};oa.prototype.isHoldoutStory=function(pa){'use strict';};oa.prototype.getHeadline=function(pa){'use strict';};oa.prototype.getPreviousStory=function(pa){'use strict';};oa.prototype.getNextStory=function(pa){'use strict';};oa.prototype.setSelected=function(pa,qa){'use strict';};oa.prototype.clickLike=function(){'use strict';};oa.prototype.clickComment=function(){'use strict';};oa.prototype.clickShare=function(){'use strict';};oa.prototype.clickSeeMore=function(){'use strict';};oa.prototype.clickLeft=function(){'use strict';};oa.prototype.clickRight=function(){'use strict';};oa.prototype.openAttachment=function(){'use strict';};oa.prototype.focusComposer=function(){'use strict';var pa=ha('pagelet_composer');if(!pa)pa=ha('pagelet_group_composer');if(pa){var qa=p.scry(pa,'textarea')[0];if(qa){s.set(qa);q.scrollToTop(true);}else{var ra=p.scry(pa,"div._36bx")[0],sa=ra&&ra.id;if(y.isComposerID(sa)){i.inform(x.ACTIVATE_ATTACHMENT+ra.id);q.scrollToTop(true);}}}};oa.prototype.getScrollOffset=function(){'use strict';return 10;};oa.prototype.getAnimationLength=function(pa){'use strict';return Math.min(Math.abs(da.getElementPosition(pa).y-ea.getTop()-aa.getTop(document.body)),400);};oa.prototype.findTop=function(){'use strict';var pa=this.getStories();for(var qa=0;qa<pa.length;qa++)if(da.getElementPosition(pa[qa]).y>da.getScrollPosition().y)return pa[qa];};oa.prototype.onLeave=function(){'use strict';this.subscriptions&&this.subscriptions.release();};oa.prototype.getHelpDialogRequest=function(){'use strict';if(!this.dialogRequest){this.dialogRequest=new k('/ajax/keyboard_shortcuts');this.dialogRequest.setReadOnly(true);}else if(this.dialogRequest.transport)return null;return this.dialogRequest;};oa.prototype.init=function(){'use strict';z.onLeave(this.onLeave.bind(this));this.subscriptions=new ba();this.subscriptions.addSubscriptions(i.subscribe(v.NAVIGATION_BEGIN,this.onLeave.bind(this)),t.register('j',this.vert.bind(this,1)),t.register('k',this.vert.bind(this,-1)),t.register('l',(function(){var pa=this.getParentStory(ia());u.like((function(){this.setSelected(pa,false);this.clickLike();}).bind(this),ia());}).bind(this),{filter:this.hasActiveStory.bind(this)}),t.register('c',this.clickComment.bind(this),{filter:this.hasActiveStory.bind(this)}),t.register('o',this.openAttachment.bind(this),{filter:this.hasActiveStory.bind(this)}),t.register('p',this.focusComposer.bind(this)),t.register('s',this.clickShare.bind(this),{filter:this.hasActiveStory.bind(this)}),t.register('SLASH',(function(){var pa=this.getHelpDialogRequest();if(pa){pa.setRelativeTo(ia());j.send(pa);}}).bind(this),{filter:function(event,pa){return event.getModifiers().shift;}}),t.register('RETURN',this.clickSeeMore.bind(this),{filter:this.hasExpandableStoryInFocus.bind(this)}),t.register('LEFT',this.clickLeft.bind(this),{filter:this.hasActiveStory.bind(this)}),t.register('RIGHT',this.clickRight.bind(this),{filter:this.hasActiveStory.bind(this)}),r.listen(this.root,'focusin',(function(event){var pa=event.getTarget();if(!this.isStory(pa)){var qa=p.isNodeOfType(pa,['object','embed','iframe']),ra=this.getParentStory(pa),sa=this.selected;if(ra&&!qa&&sa){this.setSelected(ra,true);this.selected=ra;}}}).bind(this)));};oa.prototype.hasActiveStory=function(event,pa){'use strict';var qa=ia();return !(qa&&o.shown(qa))||!!this.getParentStory(qa);};oa.prototype.hasExpandableStoryInFocus=function(event,pa){'use strict';var qa=ia();return !!(qa.getElementsByClassName('text_exposed_root').length&&!qa.getElementsByClassName('text_exposed_root text_exposed').length);};oa.prototype.clickElement=function(pa,qa){'use strict';if(!pa)return;var ra;for(var sa=1,ta=arguments.length;sa<ta;sa++){ra=p.scry(pa,arguments[sa])[0];if(ra&&o.shown(ra)){ra.click();return;}}};oa.prototype.click=function(pa){'use strict';this.clickElement(this.selected,pa);};oa.prototype.$FeedBaseKeyboardController1=function(){'use strict';if(!this.$FeedBaseKeyboardController2){this.subscriptions.addSubscriptions(r.listen(document,'scroll',(function(){if(this.selected&&!this.scrolling)this.setSelected(null,false);}).bind(this)));this.$FeedBaseKeyboardController2=true;}};oa.prototype.$FeedBaseKeyboardController3=function(){'use strict';if(!this.$FeedBaseKeyboardController4){na();this.subscriptions.addSubscriptions(r.listen(window,'resize',la(na)));this.$FeedBaseKeyboardController4=true;}};oa.prototype.vert=function(pa){'use strict';this.$FeedBaseKeyboardController1();var qa,ra;if(this.selected){if(l.isEnabled('kbshortcuts_feed')){ra=pa>0?'kbshortcuts.scroll_down':'kbshortcuts.scroll_up';m.bumpEntityKey('kbshortcuts_feed',ra);n.log('feed_scroll',ra,{});}h.logJKKey();if(this.selected.id=='pagelet_composer'){qa=pa>0?this.getStories()[0]:null;if(this.isHoldoutStory(qa))qa=this.getPreviousStory(qa);}else if(pa===0){qa=this.selected;}else qa=pa>0?this.getNextStory(this.selected):this.getPreviousStory(this.selected)||ha('pagelet_composer');if(!qa){return;}else if(!ka(qa)){o.removeClass(this.selected,'selectedStorySimple');this.selected=qa;return this.vert(pa);}}if(!qa||w.byClass(qa,'hidden_elem')||!p.contains(document,qa)){qa=this.findTop();if(qa&&pa<0)qa=this.getPreviousStory(qa);if(this.isHoldoutStory(qa))qa=this.getPreviousStory(qa);}if(!qa)return;this.anim&&this.anim.stop();var sa=Date.now()-(this.lastScroll||0)>30,ta=ga;if(pa!==0)ta=this.setFocused.bind(this,qa);if(ja()){sa=false;ta();ta=ga;}this.scrolling=true;this.scrollingTimer&&clearTimeout(this.scrollingTimer);this.$FeedBaseKeyboardController3();this.anim=q.scrollTo(qa,sa?this.getAnimationLength(qa):0,false,da.getViewportDimensions().y-ma-this.getScrollOffset(),0,(function(){this.scrollingTimer=setTimeout((function(){this.scrolling=false;}).bind(this),300);var ua=da.getScrollPosition();ta();if(ua.distanceTo(da.getScrollPosition())!==0)q.scrollTo(ua,0);}).bind(this));this.setSelected(qa,true);this.lastScroll=Date.now();};oa.prototype.setTabindexOnStory=function(pa,qa){'use strict';if(this.isStory(pa))pa.tabIndex=qa;};oa.prototype.setFocused=function(pa){'use strict';if(this.isStory(pa))s.setWithoutOutline(pa);};f.exports=oa;},null);
__d('MetaComposerEdDialog',['ARIA','Animation','Arbiter','AsyncRequest','DOM','Ease','Parent','SelectorDeprecated','Vector','getElementText'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r=null;function s(t){this._dialog=t.dialog;this.config=t;this._init();}s.init=function(t){if(r){r.config.show_audience=t.show_audience;t.dialog.destroy();return;}r=new s(t);};Object.assign(s.prototype,{_init:function(){j.subscribe(['ComposerXStatusAttachment/ready','ReactComposerStatusLazyAttachment/mounted'],(function(){if(this.config.show_audience){this._sendEducationRequest({},'/ajax/composer/audience/education',this._handlerCustomDuration.bind(this,6000));this.config.show_audience=false;}}).bind(this));if(this.config.show_sticky)j.subscribe('composer/mutate',(function(t,u){this._sendEducationRequest({sticky_num:this.config.n_sticky_shown},'/ajax/composer/audience/sticky_education');}).bind(this));if(this.config.show_tags)j.subscribe('SelectedPrivacyOption/changed',(function(t,u){this._sendEducationRequest({ids:u.tags,from:'WithTagger',hasEvent:u.hasEvent,type:u.privacy,tag_num:this.config.n_tag_shown},'/ajax/composer/audience/tag_education',this._handler.bind(this));}).bind(this));o.subscribe('open',this._killAnim.bind(this));},_sendEducationRequest:function(t,u,v){if(!this._updateDialogContext())return;this._async&&this._async.abort();this._async=new k(u);this._async.setData(t).setHandler(v).send();},_updateDialogContext:function(){var t=l.scry(document.body,'div.composerAudienceWrapper'),u,v;for(var w=0;w<t.length;w++){u=t[w];v=p.getElementPosition(u);if(u&&v.x>0&&v.y>0){this._dialog.setContext(u);return true;}}return false;},_handler:function(t){this._handlerCustomDuration(1500,t);},_handlerCustomDuration:function(t,u){var v=u.payload;if(!v||!this._updateDialogContext())return;var w=this._dialog.getContent().firstChild;l.setContent(w,v);h.announce(q(w));this._dialog.show();var x=n.byClass(w,'metaComposerUserEd');if(this._anim){this._anim.stop();this._anim=new i(x);}else this._anim=new i(x).from('opacity',0);this._anim.to('opacity',1).ease(m.sineOut).checkpoint().duration(t).checkpoint().to('opacity',0).ease(m.sineOut).checkpoint().ondone(this._killAnim.bind(this)).go();},_killAnim:function(t,u){if(this._anim){this._dialog.hide();this._anim.stop();this._anim=null;}}});f.exports=s;},null);
__d('PrivacySelectorOptionNew',['CSS','DOM','DOMQuery','JSXDOM','MenuSelectableItem','PrivacyConst','csx','cx','fbt','invariant'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s;r=babelHelpers.inherits(t,l);s=r&&r.prototype;function t(u){'use strict';s.constructor.call(this,u);this.updateAfterTagExpansion(!!u.hasTags);}t.prototype._getData=function(){'use strict';return this._data;};t.prototype.getTooltip=function(){'use strict';return this._getData().tooltip;};t.prototype.getPostParam=function(){'use strict';return this._getData().postParam.toString();};t.prototype.getTriggerIcon=function(){'use strict';return this._getData().triggerIcon;};t.prototype.getTriggerLabel=function(){'use strict';return this._getData().triggerLabel;};t.prototype.isPublic=function(){'use strict';return this.getPostParam()===m.PostParam.EVERYONE;};t.prototype.isFriends=function(){'use strict';return this.getPostParam()===m.PostParam.FRIENDS;};t.prototype.isOnlyMe=function(){'use strict';return this.getPostParam()===m.PostParam.ONLY_ME;};t.prototype.isBasicOption=function(){'use strict';return true;};t.prototype.isCustomOption=function(){'use strict';return false;};t.prototype.getTagExpansionBehavior=function(){'use strict';return this._getData().tagExpansionBehavior;};t.prototype.getBaseValue=function(){'use strict';return this._getData().baseValue;};t.prototype.getIndex=function(){'use strict';return this._getData().value;};t.prototype.getLoggingEventName=function(){'use strict';switch(this.getPostParam()){case m.PostParam.FRIENDS:return 'click_friends';case m.PostParam.EVERYONE:return 'click_everyone';case m.PostParam.ONLY_ME:return 'click_only_me';case m.PostParam.FRIENDS_MINUS_ACQUAINTANCES:return 'click_friends_except_acquaintances';case m.PostParam.FB_ONLY:return 'click_fb_only';default:return 'click_other';}};t.prototype.updateAfterTagExpansion=function(u){'use strict';var v=this._getData().triggerLabel;if(u&&this._getData().showPlusOnTagExpansion)v=p._("{privacyLabel} (+)",[p.param('privacyLabel',this._getData().triggerLabel)]);this._setLabel(v);var w=this._getExpansionType(u),x=this._getData().optionSubtitles||{};this._setSubtitle(x[w]);};t.prototype.isBelowFold=function(){'use strict';var u=h.hasClass(this.getRoot(),"_3ey_");return u;};t.prototype._setLabel=function(u){'use strict';if(!u)return;var v=j.find(this.getRoot(),"._54nh");v&&i.setContent(v,u);this._getData().label=u;};t.prototype._setSubtitle=function(u){'use strict';if(!u)return;var v=j.find(this.getRoot(),"._48u1");v&&i.setContent(v,u);};t.prototype._getExpansionType=function(u){'use strict';return u?m.ExpansionType.TAGS_ONLY:m.ExpansionType.NONE;};t.prototype.render=function(){'use strict';var u=s.render.call(this);if(!this._getData().isPrimaryOption)return u;var v=j.find(u,"._54nc");v&&h.addClass(v,"_48t_");var w=i.find(u,"._54nh");w&&h.addClass(w,"_48u0");var x=k.div({className:"_48u1"},this._getData().optionSubtitle);i.appendContent(v,x);return u;};f.exports=t;},null);
__d("XPrivacySelectorLoggingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/privacy\/selector\/log\/",{event:{type:"Enum",required:true,enumType:1},render_location:{type:"Int",required:true},content_type:{type:"String",required:true}});},null);
__d('PrivacySelectorCustomOption',['AsyncDialog','AsyncRequest','DataStore','PrivacySelectorOptionNew','XPrivacySelectorLoggingController','XPrivacyCustomDialogController'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;n=babelHelpers.inherits(p,k);o=n&&n.prototype;function p(q){'use strict';o.constructor.call(this,q);}p.prototype.isBasicOption=function(){'use strict';return false;};p.prototype.isCustomOption=function(){'use strict';return true;};p.prototype.getSelector=function(){'use strict';return this._selector;};p.prototype.setPostParam=function(q){'use strict';this._data.postParam=q;};p.prototype.getLoggingEventName=function(){'use strict';return 'click_custom';};p.prototype.openDialog=function(q){'use strict';if(typeof this._selector==='undefined')this._selector=q;j.set(this._data.id,'PrivacySelectorCustomOption',this);var r=m.getURIBuilder().setString('option_id',this._data.id).setString('id',this._data.privacyfbid.toString()).setString('post_param',q.getPostParam()).setString('content_type',q.getContentType()).setInt('render_location',q.getRenderLocation()).setIntVector('tags',q.getTags()).setBool('autosave',this._data.autosave).setBool('limit_community',this._data.limitcommunity).setBool('limit_facebook',this._data.limitfacebook).setBool('limit_fof',this._data.limitfof).setBool('limit_tagexpand',this._data.limittagexpand).setBool('is_new_privacy_selector',true).setString('tag_expansion_button',q.getTagExpansionButton()).getURI(),s=new i(r);s.setRelativeTo(q.getTriggerButtonElement());h.send(s,function(t){var u=function(v){var w=l.getURIBuilder().setEnum('event',v).setInt('render_location',document.getElementsByName('render_location')[0].value).setString('content_type',document.getElementsByName('content_type')[0].value).getURI();new i().setURI(w).send();};t.subscribe('hide',function(){q.inform('custom/hide');q.inform('selectorFinished');});t.subscribe('success',function(){q.inform('custom/success');u('custom_save');});t.subscribe('cancel',function(){q.inform('custom/cancel');u('custom_cancel');});});};p.customPrivacySave=function(q,r){'use strict';var s=j.get(q,'PrivacySelectorCustomOption');s.getSelector().selectOption(r);j.remove(q,'PrivacySelectorCustomOption');};f.exports=p;},null);
__d('PrivacySelectableMenu',['Arbiter','AsyncRequest','CSS','Ease','PrivacySelectorCustomOption','PrivacySelectorOptionNew','SelectableMenu','SelectableMenuUtils','XPrivacySelectorLoggingController','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r,s;r=babelHelpers.inherits(t,n);s=r&&r.prototype;function t(u,v){'use strict';s.constructor.call(this,u,v);}t.prototype.getItemForIndex=function(u){'use strict';for(var v=0;v<this._items.length;v++){var w=this._items[v];if(w instanceof m&&w.getIndex()==u)return w;}return null;};t.prototype.selectDefaultOption=function(){'use strict';this._items.some(function(u){if(u instanceof m&&this._isDefaultOption(u)){this.setValue(u.getIndex());return true;}return false;},this);};t.prototype.selectOption=function(u){'use strict';var v=null,w=this._items.some(function(x){if(x instanceof m&&!x.isCustomOption()&&x.getPostParam()==u){this.setValue(x.getIndex());return true;}if(x instanceof l){v=x;return false;}if(this._isMoreOption(x)){this.expandMenu();return false;}},this);if(!w&&v){v.setPostParam(u);this.setValue(v.getIndex());}};t.prototype._isDefaultOption=function(u){'use strict';return j.hasClass(u.getRoot(),"_plx");};t.prototype._isMoreOption=function(u){'use strict';return j.hasClass(u.getRoot(),"_po2");};t.prototype._handleItemClick=function(u,v){'use strict';if(!o.doesItemSupportSelect(u))return s._handleItemClick.call(this,u,v);if(this._isMoreOption(u)){this._logMoreClick();this.expandMenu();return;}this._logOptionClick(u);var w=this.inform('itemclick',{item:u,event:v});if(w)return;if(!o.isSelected(u)&&!u.isCustomOption()&&u.select()!==false){this._items.forEach(function(x){if(o.isSelected(x)&&x!==u)x.deselect();});this.inform('change',this.getSelection());}h.inform('composerprivacy/aborteducation');this.done();return u.handleClick();};t.prototype._logMoreClick=function(){'use strict';var u=p.getURIBuilder().setEnum('event','more_options').setInt('render_location',this._config.renderlocation).setString('content_type',this._config.contenttype).getURI();new i().setURI(u).send();};t.prototype._logOptionClick=function(u){'use strict';var v=p.getURIBuilder().setEnum('event',u.getLoggingEventName()).setInt('render_location',this._config.renderlocation).setString('content_type',this._config.contenttype).getURI();new i().setURI(v).send();};t.prototype.expandMenu=function(){'use strict';j.removeClass(this.getRoot(),"_po3");j.addClass(this.getRoot(),"_po4");this.inform('expandMenu');};t.prototype.collapseMenu=function(){'use strict';j.removeClass(this.getRoot(),"_po4");j.addClass(this.getRoot(),"_po3");};t.prototype.updateOptionsAfterTagExpansion=function(u){'use strict';this.forEachItem(function(v){if(v instanceof m)v.updateAfterTagExpansion(u);});};t.prototype.onPopoverOpen=function(u){'use strict';if(this._config.learnMore)this._config.learnMore.collapse();if(u&&u.isBelowFold()){this.expandMenu();}else this.collapseMenu();if(u&&this._items.indexOf(u)>=15)setTimeout((function(){this._scrollableArea.scrollToBottom(true,{duration:1000,ease:k.sineOut});}).bind(this),250);};f.exports=t;},null);
__d('PopoverButton',['DOM','DOMQuery','csx','isTextNode'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l={setLabel:function(m,n){var o=i.find(m,"._55pe"),p=o.childNodes;for(var q=0;q<p.length;q++)if(k(p[q])){h.replace(p[q],n);return;}h.appendContent(o,n);}};f.exports=l;},null);
__d('PrivacySelectorDataStore',['ArbiterMixin','PrivacySelectorNewDispatcher','KeyedCallbackManager'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=new j(),l=babelHelpers._extends({},h,{get:function(m,n){k.executeOrEnqueue(m,n);},hasValueChanged:function(m){return !!k.getResource(m);}});i.register(function(m){if(m.selector_type){var n={};n[m.selector_type]={post_param:m.post_param,unique_id:m.unique_id,reload:m.reload,is_error:m.is_error};k.addResourcesAndExecute(n);l.inform('change');}});f.exports=l;},null);
__d("XPrivacySelectorUpdateController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/privacy\/selector\/update\/",{privacy_fbid:{type:"String",required:true},post_param:{type:"String",required:true},tags:{type:"IntVector"},render_location:{type:"Int",required:true},is_saved_on_select:{type:"Bool",defaultValue:false},should_return_tooltip:{type:"Bool",defaultValue:false},replace_on_select:{type:"Bool",defaultValue:false},prefix_tooltip_with_app_privacy:{type:"Bool",defaultValue:false},ent_id:{type:"String",required:true},tag_expansion_button:{type:"String"},reload_selector:{type:"Bool",defaultValue:false}});},null);
__d('PrivacySelectorBase',['ArbiterMixin','AsyncRequest','Animation','Button','CSS','CurrentUser','Focus','Input','MenuStaticItem','MenuSelectableItem','PopoverButton','PopoverLoadingMenu','PrivacyConst','DataStore','PrivacySelectorNewDispatcher','PrivacySelectorDataStore','PrivacySelectableMenu','Run','SubscriptionsHandler','TagExpansionButtonConfig','TooltipData','XPrivacySelectorLoggingController','XPrivacySelectorUpdateController','XUIError','bind','cx','fbt','mixin'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia){if(c.__markCompiled)c.__markCompiled();var ja,ka,la=3;ja=babelHelpers.inherits(ma,ia(h));ka=ja&&ja.prototype;function ma(na,oa,pa,qa,ra,sa){'use strict';ka.constructor.call(this);u.set(na,'selector',this);this._root=na;this._button=oa;this._config=sa;this._menu=pa;this._popoverMenu=ra;this._input=qa;this._isSavedOnSelect=sa.is_saved_on_select;this._privacyFBID=sa.privacy_fbid;this._contentType=sa.content_type;this._renderLocation=sa.render_location;this._supportsTagExpansion=sa.supports_tag_expansion;this._prefixTooltipApps=sa.should_prefix_tooltip_apps;this._shouldDisplayLabel=sa.should_display_label;this._tags=sa.tagged_uids;this._hasTags=this._tags.length>0;this._entID=sa.ent_id;this._popover=this._popoverMenu.getPopover();this._receivingUpdate=false;this._initTagExpansionButtonState();this._selectorSyncKey=sa.selector_sync_key;this._previousParam=null;this._confirmOnSave=false;this._confirmOnSaveDialogs={};this._listeners=new z();if(sa.use_async_menu){this._listeners.addSubscriptions(this._popoverMenu.subscribe('setMenu',(function(){this._menu=this._popoverMenu.getMenu();if(!(this._menu instanceof x))return;this._onMenuLoad();this._onPopoverOpen();this.inform('asyncMenuLoaded');}).bind(this)));}else this._onMenuLoad();if(this._selectorSyncKey)this._initSelectorSync();y.onLeave(this._cleanup.bind(this));}ma.prototype._cleanup=function(){'use strict';this._listeners&&this._listeners.release();this._listeners=null;};ma.prototype._initSelectorSync=function(){'use strict';this._listeners.addSubscriptions(w.subscribe('change',(function(){w.get(this._selectorSyncKey,(function(na){if(na.unique_id!==this._menu._config.id){this._receivingUpdate=true;if(na.post_param)this.selectOption(na.post_param);na.reload&&this.reloadSelector();na.is_error&&this._displayErrorWithoutFocus();if(!na.post_param)this._receivingUpdate=false;}}).bind(this));}).bind(this)));if(!this._syncsToDefault())this._listeners.addSubscriptions(this._menu.subscribe('change',(function(){if(!this._shouldDisplaySuccessAndFailure())this._broadcastUpdate();}).bind(this)));};ma.prototype._broadcastUpdate=function(){'use strict';this._broadcastUpdateImpl(false);};ma.prototype._broadcastError=function(){'use strict';this._broadcastUpdateImpl(true);};ma.prototype._broadcastUpdateImpl=function(na){'use strict';if(!this._receivingUpdate){var oa={selector_type:this._selectorSyncKey,unique_id:this._menu._config.id};if(na){oa.is_error=na;}else{var pa=this._getSelectedOption();oa.post_param=pa.getPostParam().toString();}v.handleUpdateFromSelector(oa);}};ma.prototype.shouldReplaceOnPost=function(){'use strict';return this._config.replace_on_post||this.isComposerWithDefault();};ma.prototype.isComposerWithDefault=function(){'use strict';return this._syncsToDefault()&&!this._config.replace_on_select;};ma.prototype._isSelectorForChangingComposerDefault=function(){'use strict';return this._syncsToDefault&&this._config.replace_on_select;};ma.prototype._syncsToDefault=function(){'use strict';return this._config.selector_sync_key==t.PrivacyField.DEFAULT_COMPOSER.toString();};ma.prototype.getIsPublicSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isPublic();};ma.prototype.getIsFriendsSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isFriends();};ma.prototype.getIsOnlyMeSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isOnlyMe();};ma.prototype.getSelectedBaseValue=function(){'use strict';return this._selectedOption&&this._selectedOption.getBaseValue();};ma.prototype.getSelectedPostParam=function(){'use strict';return this._selectedOption&&this._selectedOption.getPostParam().toString();};ma.prototype.getIsCustomOptionSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isCustomOption();};ma.prototype.setValue=function(na){'use strict';this._menu.setValue(na);};ma.prototype.openSelectorExpanded=function(na){'use strict';this.openSelector((function(){this._menu.expandMenu();na&&na();}).bind(this));};ma.prototype.openSelector=function(na){'use strict';if(this._menu instanceof s){this.subscribeOnce('asyncMenuLoaded',(function(){na&&na();}).bind(this));this._popover.showLayer();}else{this._popover.showLayer();na&&na();}};ma.prototype.closeSelector=function(){'use strict';this._popover.hideLayer();};ma.prototype.getPopover=function(){'use strict';return this._popover;};ma.prototype.getTriggerButtonElement=function(){'use strict';return this._button;};ma.prototype.getRoot=function(){'use strict';return this._root;};ma.prototype.getMenuElement=function(){'use strict';return this._menu.getRoot();};ma.prototype.selectDefaultOption=function(){'use strict';this._menu.selectDefaultOption();this._updateMenu();};ma.prototype.selectOption=function(na){'use strict';if(!na)return;if(this._menu instanceof s){this.subscribeOnce('asyncMenuLoaded',this._selectOptionImpl.bind(this,na));this._fetchAsyncMenu();}else this._selectOptionImpl(na);};ma.prototype._selectOptionImpl=function(na){'use strict';this._menu.selectOption(na);this._updateMenu();};ma.prototype._updateMenu=function(){'use strict';this._selectedOption=this._getSelectedOption();this.updateDataForItemIndex(this._selectedOption.getIndex(),this._selectedOption.getPostParam().toString());};ma.prototype.setTagExpansionButton=function(na){'use strict';this._tagExpansionButton=na;if(this._hasAudienceExpansion()){this._menu.updateOptionsAfterTagExpansion(this._showTagExpansion());this._updateTriggerButtonLabel();this._updateTooltipAfterChange();}};ma.prototype.getTagExpansionButton=function(){'use strict';return this._tagExpansionButton;};ma.prototype._initTagExpansionButtonState=function(){'use strict';this._tagExpansionButton=aa.FRIENDS_OF_TAGGED;var na=this._getSelectedOption();if(!na)return;var oa=JSON.parse(na.getPostParam());if(oa.settings&&oa.settings.no_tag_expansion===true){this._tagExpansionButton=aa.TAGGED_ONLY;}else this._tagExpansionButton=aa.FRIENDS_OF_TAGGED;};ma.prototype._fetchAsyncMenu=function(){'use strict';if(this._config.use_async_menu)this._popoverMenu.fetchMenu();};ma.prototype._getSelectedOption=function(){'use strict';if(!(this._menu instanceof x))return;var na;this._menu.forEachItem((function(oa){if(oa instanceof q&&oa.isSelected())na=oa;}).bind(this));return na;};ma.prototype._onItemClick=function(na,oa){'use strict';var pa=oa.item;if(pa instanceof p)return;if(pa.isBasicOption()){this.updateDataForItemIndex(pa.getIndex(),pa.getPostParam().toString());}else if(pa.isCustomOption()){this._closeForCustom=true;pa.openDialog(this);}this.inform('click',{customSelected:pa.isCustomOption()});};ma.prototype.getContentType=function(){'use strict';return this._contentType;};ma.prototype.getRenderLocation=function(){'use strict';return this._renderLocation;};ma.prototype.getPostParam=function(){'use strict';return this._postParam;};ma.prototype.getTags=function(){'use strict';return this._tags;};ma.prototype.registerConfirmOnSaveDialog=function(na,oa,pa){'use strict';this._confirmOnSave=true;if(!(na in this._confirmOnSaveDialogs))this._confirmOnSaveDialogs[na]={};pa.subscribe('hide',(function(){if(this._previousParam!==this._postParam)this.selectOption(this._previousParam);}).bind(this));pa.subscribe('button',(function(){this._savePrivacy();pa.hide();}).bind(this));this._confirmOnSaveDialogs[na][oa]=pa;};ma.prototype.updateDataForItemIndex=function(na,oa,pa){'use strict';if(pa){this._tagExpansionButton=pa;this.inform('CustomTagExpansion',this._tagExpansionButton);}var qa=this._menu.getItemForIndex(na);if(qa.isCustomOption())qa.setPostParam(oa);this._selectedOption=qa;this._previousParam=this._postParam;this._postParam=oa;o.setValue(this._input,oa);this._updateTriggerButtonLabel();if(this._shouldUpdateTooltips()){this._updateTooltipAfterChange();}else{if(this._isSavedOnSelect)if(this._confirmOnSave&&this._previousParam in this._confirmOnSaveDialogs&&this._postParam in this._confirmOnSaveDialogs[this._previousParam]){this._confirmOnSaveDialogs[this._previousParam][this._postParam].show();}else this._savePrivacy();this._setTooltipValue(this._selectedOption.getTooltip());}this.inform('changed',{post_param:this._postParam,base_value:this.getSelectedBaseValue()});};ma.prototype._shouldUpdateTooltips=function(){'use strict';return this._prefixTooltipApps||this._supportsTagExpansion||this.getIsCustomOptionSelected();};ma.prototype._savePrivacy=function(){'use strict';this._previousParam=this._postParam;this._sendUpdateRequest();};ma.prototype.reloadSelector=function(){'use strict';this._cleanup();var na=da.getURIBuilder().setString('privacy_fbid',String(this._privacyFBID)).setString('post_param',this._postParam).setInt('render_location',this._renderLocation).setBool('reload_selector',true).setString('ent_id',String(this._entID)).getURI();new i().setRelativeTo(this._root).setHandler(this.inform.bind(this,'reloaded')).setURI(na).send();};ma.prototype._sendUpdateRequest=function(){'use strict';var na=this._isSavedOnSelect&&!this._receivingUpdate,oa=this._shouldUpdateTooltips();if(!na&&!oa){this._receivingUpdate=false;return;}if(this._shouldDisplaySuccessAndFailure()){k.setIcon(this._button,this._config.spinner);l.show(this._config.spinner);l.hide(this._config.checkmark);}var pa=da.getURIBuilder().setString('privacy_fbid',String(this._privacyFBID)).setString('post_param',this._postParam).setIntVector('tags',this._tags).setInt('render_location',this._renderLocation).setBool('is_saved_on_select',na).setBool('should_return_tooltip',oa).setBool('prefix_tooltip_with_app_privacy',this._prefixTooltipApps).setBool('replace_on_select',this._config.replace_on_select).setString('ent_id',String(this._entID)).setString('tag_expansion_button',this._tagExpansionButton).getURI(),qa=new i().setRelativeTo(this._root).setHandler(fa(this,function(ra){if(this._shouldDisplaySuccessAndFailure()&&!this._receivingUpdate){l.hide(this._config.spinner);this._updateTriggerButtonLabel();if(this._config.checkmark){this._updateTriggerButtonLabel();var sa=k.getIcon(this._button);l.hide(sa);new j(this._config.checkmark).show().from('opacity',0).to('opacity',1).duration(400).checkpoint().duration(200).checkpoint().from('opacity',1).to('opacity',0).duration(400).hide().ondone(function(){new j(sa).show().from('opacity',0).to('opacity',1).duration(300).go();}).go();}this._broadcastUpdate();}if(this._config.replace_on_select)this._cleanup();if(this._isSelectorForChangingComposerDefault())this._broadcastUpdate();var ta=ra&&ra.payload&&ra.payload.tooltip;ta&&this._setTooltipValue(ra.payload.tooltip);this.inform('selector_updated');})).setFinallyHandler(fa(this,function(ra){this._receivingUpdate=false;})).setURI(pa);if(this._shouldDisplaySuccessAndFailure())qa.setErrorHandler(fa(this,function(ra){if(this._receivingUpdate){this._displayErrorWithoutFocus();return;}this._menu.selectOption(this._previousParam);this._postParam=this._previousParam;this._displayError();this._broadcastError();}));qa.send();};ma.prototype._displayError=function(){'use strict';this._displayErrorImpl(true);};ma.prototype._displayErrorWithoutFocus=function(){'use strict';this._displayErrorImpl(false);};ma.prototype._displayErrorImpl=function(na){'use strict';if(this._shouldDisplaySuccessAndFailure()){r.setLabel(this._button,ha._("Select Audience"));k.setIcon(this._button,this._config.error_icon);l.show(this._config.error_icon);ba.remove(this._button);na&&n.setWithoutOutline(this._button);ea.set({target:this._button,message:ha._("Your selection might not have been saved. We recommend trying again later.")});}};ma.prototype.informTagsChanged=function(na){'use strict';var oa=this._getTags(na);this.informTagsChangedWithIDs(oa);};ma.prototype.informTagsChangedWithIDs=function(na){'use strict';var oa=!na.length;if(this._hasTags===oa){this._hasTags=!!na.length;this._menu.updateOptionsAfterTagExpansion(this._showTagExpansion());this._updateTriggerButtonLabel();}if(this._tags.length!==na.length){this._tags=na;this._updateTooltipAfterChange();}};ma.prototype._showTagExpansion=function(){'use strict';return this._hasTags&&this._tagExpansionButton.valueOf()===aa.FRIENDS_OF_TAGGED.valueOf();};ma.prototype._getTags=function(na){'use strict';var oa=[],pa=m.getID();if(na.withTags)for(var qa=0;qa<na.withTags.length;qa++){var ra=na.withTags[qa].info;if(ra.uid!=pa)oa.push(ra.uid);}if(na.mention)for(var sa in na.mention)if(na.mention[sa].type=='user'&&na.mention[sa].uid!=pa)oa.push(na.mention[sa].uid);return oa;};ma.prototype._updateTriggerButtonLabel=function(){'use strict';var na=this._selectedOption.getTriggerIcon();if(this._config.trigger_no_icon)l.hide(na);k.setIcon(this._button,na.cloneNode());if(!this._shouldDisplayLabel)return;r.setLabel(this._button,this._selectedOption.getLabel());if(this._config.trigger_style===la){l.conditionClass(this.getTriggerButtonElement(),"_mw-",this.getIsOnlyMeSelected());l.conditionClass(this.getTriggerButtonElement(),"_mw_",this.getIsPublicSelected());}};ma.prototype._updateTooltipAfterChange=function(){'use strict';var na=ha._("Loading...");this._setTooltipValue(na);this._sendUpdateRequest();};ma.prototype._setTooltipValue=function(na){'use strict';na&&ba.set(this._button,na);};ma.prototype._onPopoverClose=function(){'use strict';if(!this._getSelectedOption())return;if(this._closeForCustom){this._closeForCustom=false;}else this.inform('selectorFinished');this.inform('close');};ma.prototype._onPopoverOpen=function(){'use strict';if(!(this._menu instanceof x))return;this._menu.onPopoverOpen(this._getSelectedOption());var na=ca.getURIBuilder().setEnum('event','opened').setInt('render_location',this._renderLocation).setString('content_type',this._contentType).getURI();new i().setURI(na).send();this.inform('open');};ma.prototype._onMenuLoad=function(){'use strict';this._listeners.addSubscriptions(this._menu.subscribe('itemclick',this._onItemClick.bind(this)),this._popover.subscribe('hide',this._onPopoverClose.bind(this)),this._popover.subscribe('show',this._onPopoverOpen.bind(this)));this._listeners.addSubscriptions(this._menu.subscribe('expandMenu',(function(){if(this._popover&&this._popover.getLayer())this._popover.getLayer().updatePosition();}).bind(this)));this._selectedOption=this._getSelectedOption();if(this._selectedOption){this._postParam=this._selectedOption.getPostParam().toString();this._previousParam=this._postParam;this._hasAudienceExpansion()&&this._updateTriggerButtonLabel();}};ma.prototype._hasAudienceExpansion=function(){'use strict';return this._hasTags;};ma.prototype._shouldDisplaySuccessAndFailure=function(){'use strict';return this._config.spinner&&this._config.checkmark&&this._config.error_icon;};f.exports=ma;},null);
__d('FbFeedKeyboardController',['CSS','DOM','DOMQuery','FbFeedHighlight','FeedBaseKeyboardController','Focus','JSXDOM','Parent','csx','cx','ge','getActiveElement','isElementNode'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u,v;function w(z){if(z.previousElementSibling)return z.previousElementSibling;z=z.previousSibling;while(z&&!t(z))z=z.previousSibling;return z||null;}function x(z){if(z.nextElementSibling)return z.nextElementSibling;z=z.nextSibling;while(z&&!t(z))z=z.nextSibling;return z||null;}u=babelHelpers.inherits(y,l);v=u&&u.prototype;y.prototype.getStories=function(z){'use strict';return j.scry(z||this.root,"._5jmm");};y.prototype.isHoldoutStory=function(z){'use strict';return !!z&&h.hasClass(z,'holdoutAdStory');};y.prototype.isRelevantStory=function(z){'use strict';return t(z)&&!this.isHoldoutStory(z);};y.prototype.isStory=function(z){'use strict';return h.hasClass(z,"_5jmm");};y.prototype.clickLike=function(){'use strict';var z=this.$FbFeedKeyboardController1();this.clickElement(z,'.UFILikeLink');if(z!==this.selected)return null;var aa=this.getParentStory(s());if(aa){var ba=j.scry(aa,'.UFILikeLink');for(var ca=0;ca<ba.length;ca++)if(!h.hasClass(ba[ca],'accessible_elem'))m.setWithoutOutline(ba[ca]);}};y.prototype.clickComment=function(){'use strict';this.clickElement(this.$FbFeedKeyboardController1(),'.comment_link');};y.prototype.clickShare=function(){'use strict';this.click('.share_action_link');};y.prototype.clickSeeMore=function(){'use strict';this.click('.see_more_link');};y.prototype.clickLeft=function(){'use strict';this.click("._1mri");};y.prototype.clickRight=function(){'use strict';this.click("._2fu-");};y.prototype.openAttachment=function(){'use strict';this.click("._5dec","a._52c6","._4-eo",'.uiVideoThumb');};y.prototype.getHeadline=function(z){'use strict';return j.scry(z,"h5._5pbw")[0];};y.prototype.$FbFeedKeyboardController2=function(z){'use strict';var aa=o.bySelector(z,"._5pcb"),ba=r('pagelet_soft_permalink_posts');return !!(aa||ba&&i.contains(ba,z));};y.prototype.getPreviousSibling=function(z){'use strict';var aa=w(z);if(aa&&this.getParentStory(aa))return aa;aa=null;if(this.$FbFeedKeyboardController2(z)){var ba=this.getStories(this.root),ca=ba.indexOf(z);while(ca>-1){if(ca===0){aa=r('pagelet_composer');aa=aa&&o.bySelector(aa,"._5jmm");}else if(ca>0){aa=ba[ca-1];if(aa.offsetHeight>0)break;}ca--;}}return aa||this.selected;};y.prototype.getPreviousStory=function(z){'use strict';var aa=this.getPreviousSibling(z);while(aa&&!this.isStory(aa))aa=this.getPreviousSibling(aa);return aa;};y.prototype.getParentStory=function(z){'use strict';return o.bySelector(z,"._5jmm");};y.prototype.getNextSibling=function(z){'use strict';var aa=x(z);if(aa&&this.getParentStory(aa))return aa;aa=null;if(this.$FbFeedKeyboardController2(z)){var ba=this.getStories(this.root),ca=ba.indexOf(z);if(ca>-1){aa=ba[++ca];while(aa&&aa.offsetHeight===0)aa=ba[++ca];}}else if(r('pagelet_composer',z))aa=j.scry(document,"div._5pcb ._5jmm")[0];return aa||this.selected;};y.prototype.getNextStory=function(z){'use strict';var aa=this.getNextSibling(z);while(aa&&!this.isStory(aa))aa=this.getNextSibling(aa);return aa;};y.prototype.setSelected=function(z,aa){'use strict';if(z){var ba="_5qdu",ca=j.scry(z,"._5qdu");if(!ca.length&&aa)i.prependContent(z,n.div({className:ba}));}if(aa){this.selected&&this.setTabindexOnStory(this.selected,'-1');this.selected&&h.removeClass(this.selected,"_5qdv");this.selected=z;z&&this.setTabindexOnStory(z,'0');z&&h.addClass(z,"_5qdv");k.highlightSingle(z);}};y.prototype.$FbFeedKeyboardController1=function(){'use strict';var z=i.scry(this.selected,"._1qch");if(z.length>0)return i.scry(this.selected,"._3el7")[0];return this.selected;};y.init=function(z){'use strict';new y(z);};function y(){'use strict';u.apply(this,arguments);}f.exports=y;},null);