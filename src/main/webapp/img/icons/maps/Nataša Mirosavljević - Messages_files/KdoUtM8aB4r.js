/*!CK:908769964!*//*1451989072,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["ucxup"]); }

__d('Droppable',['Collection','Drag','Draggable','Vector','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(n){'use strict';if(!n)throw new Error('Element should be a DOM node');if(!(this instanceof m)){if(n instanceof Array){var o=[];n.forEach(function(p){o.push(new m(p));});return new h(m,o);}else return new m(n);}else{this.data={};this.dom=n;this.namespace=null;}}m.prototype.destroy=function(){'use strict';if(this.namespace)i.removeDroppable(this.namespace,this);this.data=this.dom=null;};m.prototype.setNamespace=function(n){'use strict';if(this.namespace)i.removeDroppable(this.namespace,this);this.namespace=n;i.addDroppable(n,this);return this;};m.prototype.setZIndex=function(n){'use strict';this.zIndex=n;return this;};m.prototype.hasPointMovedHorizontally=function(n){'use strict';var o=k.getElementPosition(this.dom);return o.x<=n.x&&this.dom.offsetWidth+o.x>n.x;};m.prototype.hasPointMovedVertically=function(n){'use strict';var o=k.getElementPosition(this.dom);return o.y<=n.y&&this.dom.offsetHeight+o.y>n.y;};m.prototype.hasPointMovedInside=function(n){'use strict';return this.hasPointMovedHorizontally(n)&&this.hasPointMovedVertically(n);};m.prototype.setDragOverHandler=function(n){'use strict';this.ondragover=n;return this;};m.prototype.setDragOverVectically=function(){'use strict';this.isDraggedOver=m.prototype.hasPointMovedVertically;return this;};m.prototype.setDragOverHorizontally=function(){'use strict';this.isDraggedOver=m.prototype.hasPointMovedHorizontally;return this;};m.prototype.setDragMoveHandler=function(n){'use strict';this.ondragmove=n;return this;};m.prototype.setDropHandler=function(n){'use strict';this.ondrop=n;return this;};m.prototype.zIndex=0;m.prototype.isDraggedOver=m.prototype.hasPointMovedInside;m.prototype.ondragover=l;m.prototype.ondragmove=l;m.prototype.ondrop=l;m.prototype.getDOM=j.prototype.getDOM;m.prototype.setKey=j.prototype.setKey;m.prototype.getKey=j.prototype.getKey;f.exports=m;},null);
__d('SortableGroup',['Arbiter','CSS','DOM','Draggable','Droppable','Style','Vector','emptyFunction','removeFromArray'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();function q(){'use strict';this.namespace='sortable'+ ++q.instanceCount;this.draggables={};this.droppables={};this.sortables={};this.linkedGroups=[];this.linkedGroups.onbeforelinkjump=o;this.linkedGroups.onlinkjump=o;this.rootNode=null;this.boundingBox=null;this.neverEmpty=false;this.hasEmptyMessage=false;this.isDroppable=true;this.isDraggable=true;this.useScroller=true;this.dragOverCriteria='inside';this.requireSameParent=true;this.previousIndexList=[];this.anchor=null;this.disabled=false;this.autoWidth=false;}q.prototype.addEmptyMessage=function(r,s){'use strict';var t='placeholder';if(r.parentNode!=s)j.appendContent(s,r);this.emptyMessage=r;this._initializeAdded(t,r);this.hasEmptyMessage=true;this.sortables[t]=r;this.droppables[t]=new l(r).setNamespace(this.namespace).setDragOverHandler(this._dragOverHandlerShim.bind(this,t));return this;};q.prototype.setAutoWidth=function(r){'use strict';this.autoWidth=r;return this;};q.prototype.setUseScroller=function(r){'use strict';this.useScroller=r;return this;};q.prototype.setDragOverHorizontally=function(){'use strict';this.dragOverCriteria='horizontal';return this;};q.prototype.setDragOverVertically=function(){'use strict';this.dragOverCriteria='vertical';return this;};q.prototype.removeEmptyMessage=function(){'use strict';if(this.emptyMessage)j.remove(this.emptyMessage);this.hasEmptyMessage=false;this.removeSortable('placeholder');return this;};q.prototype.addSortable=function(r,s,t,u){'use strict';this._initializeAdded(r,s);this.sortables[r]=s;this.draggables[r]=new k(s).setNamespace(this.namespace).setGutter(this.gutter).setUseAbsolute(true).setUseScroller(this.useScroller).setGrabHandler(this.grabHandler.bind(this,r)).setDropHandler(this.dropHandler.bind(this,r,u)).setKey('key',r).setBoundingBox(this.boundingBox);if(t)this.draggables[r].addHandle(t);this.droppables[r]=new l(s).setNamespace(this.namespace).setDragOverHandler(this._dragOverHandlerShim.bind(this,r));if(this.dragOverCriteria==='horizontal'){this.droppables[r].setDragOverHorizontally();}else if(this.dragOverCriteria==='vertical')this.droppables[r].setDragOverVectically();return this;};q.prototype.destroy=function(){'use strict';for(var r in this.droppables)this.droppables[r].destroy();for(var s in this.draggables)this.draggables[s].destroy();this.droppables=this.draggables=this.rootNode=null;p(this.linkedGroups,this);for(var t=0;t<this.linkedGroups.length;t++)this.linkedGroups[t].linkedGroups=this.linkedGroups;};q.prototype.dragOverHandler=function(r,s){'use strict';if(!this.isDroppable&&!this.anchor)return;var t=false;if(!(s in this.draggables)){this.linkedGroups.onbeforelinkjump.call(this,s);if(!this.migrateLinkedSortable(s))throw new Error('Draggable dropped onto a foreign droppable!');t=true;}var u=true,v=this.getSortables(),w=this.sortables[s],x=this.sortables[r];if(!this.anchor){var y=v.length;for(var z=0;z<y;z++)if(v[z]==x){break;}else if(v[z]==w){u=false;break;}}else x=this.anchor;this.onbeforedragover(w,x);var aa=this.linkedGroups.placeholder;this.insertPlaceholder(aa,x,u||this.anchor);aa.parentNode.insertBefore(w,aa);this.ondragover(w,x,s,r);if(t)this.linkedGroups.onlinkjump.call(this,s);};q.prototype.dropHandler=function(r,s){'use strict';if(this._checkLastRemaining()){this.draggables[r].resetPosition();return;}var t=this.linkedGroups.placeholder;i.removeClass(this.sortables[r],'drag');this.draggables[r].resetPosition();t.parentNode.insertBefore(this.sortables[r],t);t.parentNode.removeChild(t);for(var u=0;u<this.linkedGroups.length;u++)if(this.linkedGroups[u].anchor)delete this.linkedGroups[u].anchor;this.ondropcallback(r,this.sortables[r]);this.onorderchange();if(this.previousIndexList.length===0)this.previousIndexList=Object.keys(this.sortables);var v=this.previousIndexList.indexOf(r),w=this.getOrder().indexOf(r);h.inform('drag-and-drop/'+s,{previousIndex:v,currentIndex:w});this.previousIndexList=this.getOrder();};q.prototype.getOrder=function(){'use strict';var r=[],s=this.getSortables();for(var t=0;t<s.length;t++)for(var u in this.sortables)if(this.sortables[u]==s[t]){r.push(u);break;}return r;};q.prototype.getSortables=function(){'use strict';return this.rootNode?this.rootNode.childNodes:[];};q.prototype.grabHandler=function(r){'use strict';if(this.disabled||this._checkLastRemaining()||!this.isDraggable){this.draggables[r].killDrag();return;}this.onbeforegrabcallback(this.sortables[r],r);var s=this.linkedGroups.placeholder,t=this.sortables[r];i.setClass(s,t.className);i.addClass(s,'droppable_placeholder');i.addClass(t,'drag');n.getElementDimensions(t).setElementDimensions(s);if(this.autoWidth)m.set(s,'width','auto');t.parentNode.insertBefore(s,t);this.ongrabcallback(this.sortables[r],r);if(!this.isDroppable){this.anchor=t.nextSibling;if(!this.anchor){this.anchor=j.create('div');t.parentNode.appendChild(this.anchor);}}};q.prototype.insertPlaceholder=function(r,s,t){'use strict';if(t){j.insertBefore(s,r);}else j.insertAfter(s,r);};q.prototype.keyExists=function(r){'use strict';return this.sortables[r];};q.prototype.link=function(r){'use strict';r.linkedGroups=this.linkedGroups;if(!this.linkedGroups.length)this.linkedGroups.push(this);this.linkedGroups.push(r);for(var s=0;s<this.linkedGroups.length;s++)if(this.linkedGroups[s].namespace!=this.namespace){this.linkedGroups[s].namespace=this.namespace;for(var t in this.linkedGroups[s].droppables){this.linkedGroups[s].droppables[t].setNamespace(this.namespace);var u=this.linkedGroups[s].draggables[t];u&&u.setNamespace(this.namespace);}}return this;};q.prototype.migrateLinkedSortable=function(r){'use strict';for(var s=0;s<this.linkedGroups.length;s++)if(r in this.linkedGroups[s].draggables){this.sortables[r]=this.linkedGroups[s].sortables[r];this.draggables[r]=this.linkedGroups[s].draggables[r];this.draggables[r].setGrabHandler(this.grabHandler.bind(this,r)).setDropHandler(this.dropHandler.bind(this,r));this.droppables[r]=this.linkedGroups[s].droppables[r];this.droppables[r].setDragOverHandler(this._dragOverHandlerShim.bind(this,r));delete this.linkedGroups[s].sortables[r];delete this.linkedGroups[s].draggables[r];delete this.linkedGroups[s].droppables[r];return true;}return false;};q.prototype.removeSortable=function(r){'use strict';if(r in this.sortables){if(r in this.draggables)this.draggables[r].destroy();if(r in this.droppables)this.droppables[r].destroy();delete this.draggables[r];delete this.droppables[r];delete this.sortables[r];}};q.prototype.removeAllSortables=function(){'use strict';for(var r in this.sortables)this.removeSortable(r);};q.prototype.setDisabled=function(r){'use strict';this.disabled=r;return this;};q.prototype.forceDrop=function(r){'use strict';if(r in this.sortables)this.draggables[r].forceDrop();};q.prototype.killDrag=function(r){'use strict';if(r in this.sortables)this.draggables[r].killDrag();};q.prototype.setBeforeGrabCallback=function(r){'use strict';this.onbeforegrabcallback=r;return this;};q.prototype.setBoundingBox=function(r){'use strict';this.boundingBox=r;for(var s in this.draggables)this.draggables[s].setBoundingBox(this.boundingBox);return this;};q.prototype.setBeforeDragOverCallback=function(r){'use strict';this.onbeforedragover=r;return this;};q.prototype.setDragOverCallback=function(r){'use strict';this.ondragover=r;return this;};q.prototype.setDropCallback=function(r){'use strict';this.ondropcallback=r;return this;};q.prototype.setDroppable=function(r){'use strict';this.isDroppable=r;return this;};q.prototype.setDraggable=function(r){'use strict';this.isDraggable=r;return this;};q.prototype.setGrabCallback=function(r){'use strict';this.ongrabcallback=r;return this;};q.prototype.setBeforeLinkJumpHandler=function(r){'use strict';this.linkedGroups.onbeforelinkjump=r;return this;};q.prototype.setInsertPlaceholderHandler=function(r){'use strict';this.insertPlaceholder=r;};q.prototype.setLinkJumpHandler=function(r){'use strict';this.linkedGroups.onlinkjump=r;return this;};q.prototype.setNeverEmpty=function(r){'use strict';this.neverEmpty=r;};q.prototype.setOrderChangeHandler=function(r){'use strict';this.onorderchange=r;return this;};q.prototype.setRequireSameParent=function(r,s){'use strict';this.requireSameParent=s;};q.prototype.setSortablesGetter=function(r){'use strict';this.getSortables=r;};q.prototype._checkLastRemaining=function(r){'use strict';var s=this.hasEmptyMessage?2:1;return this.neverEmpty&&this.getSortables().length==s;};q.prototype._dragOverHandlerShim=function(r,s){'use strict';this.dragOverHandler(r,s.getKey('key'));};q.prototype._initializeAdded=function(r,s){'use strict';if(this.rootNode===null){this.rootNode=s.parentNode;if(!this.linkedGroups.placeholder)this.linkedGroups.placeholder=j.create(s.tagName,{className:'dragPlaceholder',style:{padding:'0'}});}else if(this.requireSameParent&&this.rootNode!=s.parentNode)throw new Error('All sortables of a collection must share the same parentNode');if(r in this.draggables)throw new Error('All sortables must have a unique key');};q.instanceCount=0;Object.assign(q.prototype,{gutter:15,onbeforegrabcallback:o,onbeforedragover:o,ondragover:o,ondropcallback:o,ongrabcallback:o,onorderchange:o});f.exports=b.SortableGroup||q;},null);
__d('WebMessengerNux',['Event','AsyncSignal','DOM','WebMessengerEvents'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();function l(m,n,o,p){function q(){j.remove(m);k.masterDOMChanged();k.detailDOMChanged();new i('/ajax/web_messenger/dismiss_nux.php').send();}h.listen(n,'click',q);h.listen(o,'click',p.show.bind(p));p.subscribe('hide',q);}f.exports=l;},null);
__d('MercuryRecipientsDataSource',['DataSource','MercuryTypeaheadConstants'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j,k;j=babelHelpers.inherits(l,h);k=j&&j.prototype;function l(m){'use strict';m=m||{};m.kanaNormalization=true;k.constructor.call(this,m);}l.prototype.buildData=function(m){'use strict';var n=[],o=[];m.forEach((function(p){var q=k.getEntry.call(this,p);if(q.render_type==i.NON_FRIEND_TYPE){var r=i.COMPOSER_NON_FRIENDS_MAX;if(o.length<r)o.push(p);}else if(n.length<i.COMPOSER_FRIENDS_MAX){q.render_type=i.FRIEND_TYPE;n.push(p);}}).bind(this));return k.buildData.call(this,n.concat(o));};f.exports=l;},null);
__d('MessagingDebug',['URI','BugBar','WebMessengerMessageIDFinder'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={showTrace:function(l){var m=j.find(l,l.getAttribute('data-selector')),n=new h(l.getAttribute('data-uri'));n.setQueryData({message_id:m,timestamp:l.getAttribute('data-timestamp')});window.open(n.toString(),'_blank');},reportBug:function(l){var m=j.find(l,l.getAttribute('data-selector')),n=l.getAttribute('data-timestamp');i.addMetadata({'Message ID':m});i.addMetadata({'Message Timestamp':n});}};f.exports=k;},null);
__d('ComposerPhotoSorter',['Arbiter','CSS','DOM','Rect','SortableGroup','arrayContains'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={init:function(o,p){this._container=o;this._noDragDuringUploading=p;this._reset();this._update();var q=this._update.bind(this);h.subscribe('multi-upload/images-added/'+o.id,q);h.subscribe('multi-upload/image-removed/'+o.id,q);},_reset:function(){this._ids=[];this._sortableGroup=new l();if(this._noDragDuringUploading){h.subscribe(['multi-upload/images-upload-start/'+this._container.id],this._sortableGroup.destroy.bind(this._sortableGroup));h.subscribe(['set-bounding-box/'+this._container.id],this._setBoundingBox.bind(this));}i.removeClass(this._container,'fbVaultPhotoSorter');},_update:function(){var o=j.scry(this._container,'.fbVaultGridItem').filter(function(p){return !i.hasClass(p,'fbVaultEditableGridMoreLink');});if(o.length<2){if(this._ids.length>1){this._sortableGroup.destroy();this._reset();}return;}i.addClass(this._container,'fbVaultPhotoSorter');o.forEach((function(p){var q=j.scry(p,'input[type="hidden"]')[0];if(q&&!m(this._ids,q.value)){this._ids.push(q.value);this._sortableGroup.addSortable(q.value,p,null,this._container.id);}}).bind(this));this._sortableGroup.setBoundingBox(new k(this._container));},_setBoundingBox:function(o,p){this._sortableGroup.setBoundingBox(p);}};f.exports=n;},null);