/*!CK:1234327283!*//*1451978245,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["tgbUy"]); }

__d('SearchableTextInput.react',['EventListener','React','AbstractTextFieldMixin.react','AbstractTextInput.react','getActiveElement'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=i.PropTypes,n=i.createClass({displayName:'SearchableTextInput',propTypes:babelHelpers._extends({},j.propTypes,{queryString:m.string,searchSource:m.object,searchSourceOptions:m.object,onEntriesFound:m.func.isRequired,searchOnFocus:m.bool,searchOnUpdate:m.bool,required:m.bool,onPaste:m.func,onFocus:m.func,onChange:m.func}),componentDidMount:function(){if(this.props.onPaste)this._listener=h.listen(this.refs.input.getTextFieldDOM(),'paste',this.props.onPaste);},componentWillReceiveProps:function(o){},componentDidUpdate:function(o){if(this.props.searchOnUpdate)if(o.queryString!==this.props.queryString)this.search(this.props.queryString);},componentWillUnmount:function(){if(this._listener){this._listener.remove();this._listener=null;}},_onInputFocus:function(){this.props.searchSource.bootstrap((function(){if(this.props.searchOnFocus)this.search(this.props.queryString);}).bind(this));this.props.onFocus&&this.props.onFocus();},_onSearchCallback:function(o,p,q){if(this.props.queryString===p)this.props.onEntriesFound(o,p,q);},_onChange:function(event){this.props.onChange&&this.props.onChange(event);var o=event.target.value;setTimeout((function(){return this.search(o);}).bind(this));},search:function(o){this.props.searchSource.search(o,this._onSearchCallback,this.props.searchSourceOptions);},focusInput:function(){var o=this.getTextFieldDOM();if(l()===o){this._onInputFocus();}else o.offsetHeight&&o.focus();},blurInput:function(){var o=this.getTextFieldDOM();o.offsetHeight&&o.blur();},getTextFieldDOM:function(){return this.refs.input.getTextFieldDOM();},render:function(){var o=this.props.queryString||'';return (i.createElement(k,babelHelpers._extends({},this.props,{onChange:this._onChange,onFocus:this._onInputFocus,ref:'input',role:'combobox',value:o})));}});f.exports=n;},null);
__d('TypeaheadView.react',['React','cx'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=h.PropTypes,k=h.createClass({displayName:'TypeaheadView',propTypes:{entries:j.array.isRequired,extraRendererProps:j.object,highlightedEntry:j.object,isVisible:j.bool,queryString:j.string,Renderer:j.func.isRequired,selectedEntry:j.object},_onSelect:function(l,m){if(this.props.onSelect)this.props.onSelect(l,m);},_onHighlight:function(l){this.props.onHighlight(l);},render:function(){var l=!this.props.isVisible?"hidden_elem":'',m=babelHelpers._extends({highlightedEntry:this.props.highlightedEntry,selectedEntry:this.props.selectedEntry,entries:this.props.entries,onSelect:this._onSelect,onHighlight:this._onHighlight,onRenderHighlight:this.props.onRenderHighlight,ariaOwneeID:this.props.ariaOwneeID,queryString:this.props.queryString},this.props.extraRendererProps),n=this.props.Renderer;return (h.createElement('div',{className:l},h.createElement(n,m)));}});f.exports=k;},null);
__d('AbstractTypeahead.react',['AbstractTextFieldMixin.react','ContextualLayer.react','InputSelection','React','ReactLayeredComponentMixin','SearchableTextInput.react','SearchSourceQueryStatus','TypeaheadNavigation','TypeaheadView.react','cx','getOrCreateDOMID','joinClasses','uniqueID'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=k.PropTypes,v=[],w=10,x=k.createClass({displayName:'AbstractTypeahead',mixins:[l],propTypes:babelHelpers._extends({},h.propTypes,{additionalElements:u.node,inputClassName:u.string,inputID:u.string,inputStyle:u.object,autoCapitalize:u.string,autoComplete:u.string,autoCorrect:u.string,queryString:u.string,searchSource:u.object.isRequired,searchSourceOptions:u.object,excludedEntries:u.object,presenter:u.object.isRequired,onSelectAttempt:u.func,onEntriesFound:u.func,onNoEntriesFound:u.func,onEnterWithoutSelection:u.func,autoHighlight:u.bool,showEntriesOnFocus:u.bool,selectOnBlur:u.bool,selectOnTab:u.bool,focusedOnInit:u.bool,hideViewWithEntries:u.bool,disabled:u.bool,entriesWidthMatchContext:u.bool,selectedEntry:u.object,onTypeaheadVisibilityChanged:u.func,onPaste:u.func,navigation:u.object}),getDefaultProps:function(){return {autoComplete:'off',autoCorrect:'off',selectOnBlur:false,selectOnTab:true,hideViewWithEntries:true,entriesWidthMatchContext:true,navigation:o};},getInitialState:function(){return {highlightedEntry:null,isArrowNavigation:false,isAutoHighlight:this.props.autoHighlight,ariaActiveDescendantID:null,ariaOwneeID:t(),activeEntries:null,focused:!!this.props.focusedOnInit,viewIsVisible:!!this.props.focusedOnInit};},_onRenderHighlight:function(y){var z=r(y);this.setState({ariaActiveDescendantID:z});},_determineViewVisibility:function(y,z){if(!y)return false;var aa=y.length>0&&(this.props.showEntriesOnFocus||this.props.queryString.length>0);return !!(z&&(this.props.presenter.alwaysVisibleOnFocus||aa));},_onEntriesFound:function(y,z,aa){if(!this.isMounted())return;if(this.props.excludedEntries){var ba=this.props.excludedEntries;y=y.filter(function(ja){return !ba.hasOwnProperty(ja.getUniqueID());});}var ca=this.props.presenter,da=typeof ca.sortEntries=='function'?ca.sortEntries(y,this.state.activeEntries,this.props.queryString):y,ea=da.slice(0,ca.maxEntries||w),fa=this._determineViewVisibility(ea,this.state.focused);if(!ea.length){this.setState({ariaActiveDescendantID:null,activeEntries:ea,highlightedEntry:null,isAutoHighlight:this.props.autoHighlight});this._setViewIsVisible(fa);if(this.props.onNoEntriesFound&&aa===n.COMPLETE)this.props.onNoEntriesFound();return;}if(this.props.onEntriesFound)this.props.onEntriesFound(ea,aa);var ga=this.state.highlightedEntry,ha=ga&&ea.indexOf(ga)!==-1;if(!this.props.autoHighlight){this.setState({activeEntries:ea,highlightedEntry:ha?ga:null});if(fa)this._setViewIsVisible(true);return;}var ia=this.state.isAutoHighlight;if(ia){ga=ea[0];}else{ga=ha?ga:ea[0];ia=!ha;}this.setState({activeEntries:ea,highlightedEntry:ga,isAutoHighlight:ia});if(fa)this._setViewIsVisible(true);},_onInputFocus:function(){var y=this._determineViewVisibility(this.state.activeEntries,true);if(y)this._setViewIsVisible(true);this.setState({focused:true});this.props.onFocus&&this.props.onFocus();},_onInputBlur:function(){if(this.props.hideViewWithEntries)this._close();if(this.props.selectOnBlur&&this.state.highlightedEntry)this.props.onSelectAttempt(this.state.highlightedEntry);this.setState({focused:false});this.props.onBlur&&this.props.onBlur();},_onInputClick:function(y){var z=this.getTextFieldDOM(),aa=j.get(z);if(aa&&aa.start==aa.end)z.select();this.props.onClick&&this.props.onClick(y);},_onEscape:function(){this._close();this.blurInput();this.setState({focused:false});this.props.onEscape&&this.props.onEscape();},_onEnter:function(event){if(this.props.onEnterWithoutSelection&&(!this.state.viewIsVisible||!this.state.highlightedEntry)){this.props.onEnterWithoutSelection(event);return;}if(!this.state.viewIsVisible)return;if(!this.state.highlightedEntry){event.preventDefault();return;}if(this.props.hideViewWithEntries)this._close();if(this.props.onSelectAttempt)this.props.onSelectAttempt(this.state.highlightedEntry,event);event.preventDefault();},_onTab:function(event){if(this.props.selectOnTab&&this.state.viewIsVisible&&this.props.onSelectAttempt&&this.state.highlightedEntry){if(this.props.hideViewWithEntries){this._close();event.preventDefault();}this.props.onSelectAttempt(this.state.highlightedEntry,event);}},_onDownArrow:function(event){event.preventDefault();this.props.navigation.moveDown(this.state.activeEntries||v,this.state.highlightedEntry,this._setHighlight);},_onUpArrow:function(event){event.preventDefault();this.props.navigation.moveUp(this.state.activeEntries||v,this.state.highlightedEntry,this._setHighlight);},_setHighlight:function(y){this.setState({highlightedEntry:y,isArrowNavigation:true,isAutoHighlight:!y});},_onInputChange:function(event){if(this.props.onChange)this.props.onChange(event);this._setViewIsVisible(this.state.focused&&(this.props.showEntriesOnFocus||event.target.value.length>0)&&(this.props.presenter.alwaysVisibleOnFocus||this.state.activeEntries!=null&&this.state.activeEntries.length>0));},_onViewHighlight:function(y){this.setState({highlightedEntry:y,isArrowNavigation:false,isAutoHighlight:false});},_getView:function(){return (k.createElement(p,{Renderer:this.props.presenter.ViewRenderer,extraRendererProps:babelHelpers._extends({},this.props.presenter.extraRendererProps,{isArrowNavigation:this.state.isArrowNavigation}),highlightedEntry:this.state.highlightedEntry,selectedEntry:this.props.selectedEntry,isVisible:this.state.viewIsVisible,ariaOwneeID:this.state.ariaOwneeID,onHighlight:this._onViewHighlight,onRenderHighlight:this._onRenderHighlight,onSelect:this.props.onSelectAttempt,entries:this.state.activeEntries||v,queryString:this.props.queryString}));},_setViewIsVisible:function(y){if(y!==this.state.viewIsVisible){if(this.props.onTypeaheadVisibilityChanged)this.props.onTypeaheadVisibilityChanged(y,this.state.activeEntries||v);this.setState({viewIsVisible:y});}},componentWillReceiveProps:function(y){if(!y.queryString&&!this.props.showEntriesOnFocus)this.clearActiveEntries();},componentDidUpdate:function(){var y=this._determineViewVisibility(this.state.activeEntries,this.state.focused);if(y)this._setViewIsVisible(true);},renderLayers:function(){if(!this.props.presenter.useLayer)return {};var y=null,z=null;if(this.props.context){y=this.props.context;}else z=(function(){return this.refs.input;}).bind(this);return {typeaheadView:k.createElement(i,{alignment:this.props.presenter.alignment,behaviors:this.props.presenter.layerBehaviors,containerWidthMatchContext:this.props.entriesWidthMatchContext,contextRef:z,context:y,position:this.props.presenter.layerPosition||"below",shown:this.state.viewIsVisible,shouldSetARIAProperties:false},this._getView())};},render:function(){var y=this.state.activeEntries,z=!!(y&&y.length),aa=k.createElement(m,{'aria-activedescendant':this.state.ariaActiveDescendantID,'aria-expanded':z,'aria-autocomplete':'list','aria-label':this.props.ariaLabel,'aria-owns':this.state.ariaOwneeID,required:this.props.required,ref:'input',autoCapitalize:this.props.autoCapitalize,autoComplete:this.props.autoComplete,autoCorrect:this.props.autoCorrect,className:this.props.inputClassName,id:this.props.inputID,queryString:this.props.queryString,placeholder:this.props.placeholder,maxLength:this.props.maxLength,searchSource:this.props.searchSource,searchSourceOptions:this.props.searchSourceOptions,searchOnFocus:!!this.props.showEntriesOnFocus,disabled:this.props.disabled,onEntriesFound:this._onEntriesFound,onEscape:this._onEscape,onBlur:this._onInputBlur,onFocus:this._onInputFocus,onChange:this._onInputChange,onDownArrow:this._onDownArrow,onUpArrow:this._onUpArrow,onTab:this._onTab,onEnter:this._onEnter,onBackspace:this.props.onBackspace,onPaste:this.props.onPaste,onClick:this._onInputClick,style:this.props.inputStyle,tabIndex:this.props.tabIndex}),ba=null;if(!this.props.presenter.useLayer)ba=this._getView();return (k.createElement('span',babelHelpers._extends({},this.props,{className:s(this.props.className,"_58ah"),onBlur:null,onClick:null,onFocus:null,tabIndex:null}),aa,this.props.additionalElements,ba));},componentDidMount:function(){if(this.props.focusedOnInit)this.focusInput();},clearActiveEntries:function(){this.setState({ariaActiveDescendantID:null,activeEntries:null,highlightedEntry:null});},focusInput:function(){var y=this.getTextFieldDOM();if(y.value)j.set(y,y.value.length);this.refs.input.focusInput();},blurInput:function(){if(this.refs.input.blur){this.refs.input.blur();}else if(this.refs.input.blurInput)this.refs.input.blurInput();},hideView:function(){this._setViewIsVisible(false);},_close:function(){this._setViewIsVisible(false);this.clearActiveEntries();},getTextFieldDOM:function(){return this.refs.input.getTextFieldDOM();}});f.exports=x;},null);
__d('XUITypeaheadTextOnlyView.react',['React','TypeaheadViewItem','TypeaheadViewPropTypes','cx'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.createClass({displayName:'XUITypeaheadTextOnlyViewItem',mixins:[i.Mixin],propTypes:i.propTypes,render:function(){var n=this.props.entry,o="_599m"+(this.props.highlighted?' '+"_599n":'');return (h.createElement('li',{'aria-label':n.getTitle(),'aria-selected':this.props.highlighted,className:o,key:n.getUniqueID(),onMouseDown:this._onSelect,onMouseEnter:this._onHighlight,role:this.props.role,title:n.getTitle()},h.createElement('div',{className:"_599p"},n.getTitle())));}}),m=h.createClass({displayName:'XUITypeaheadTextOnlyView',propTypes:j,getDefaultProps:function(){return {role:'listbox'};},_renderItem:function(n){var o=n===this.props.highlightedEntry;return (h.createElement(l,{entry:n,highlighted:o,key:n.getUniqueID(),onSelect:this.props.onSelect,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight}));},render:function(){var n="_599r"+(!this.props.entries.length?' '+"_599s":'');return (h.createElement('ul',{className:n,id:this.props.ariaOwneeID,role:this.props.role},this.props.entries.map(this._renderItem)));}});f.exports=m;},null);
__d('XUITypeahead.react',['AbstractTypeahead.react','React','Image.react','SearchableEntry','XUICloseButton.react','XUIError.react','XUITypeaheadTextOnlyView.react','XUITypeaheadView.react','cx','joinClasses','update'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s=i.PropTypes,t={ViewRenderer:o,useLayer:true},u={ViewRenderer:o,useLayer:false},v={ViewRenderer:n,useLayer:true},w=i.createClass({displayName:'XUITypeahead',propTypes:babelHelpers._extends({maxEntries:s.number,onChange:s.func.isRequired,onSelectAttempt:s.func.isRequired,onEntriesFound:s.func,onNoEntriesFound:s.func,selectedEntry:s.instanceOf(k),tallInput:s.bool,viewStyle:s.oneOf(['textonly','rich','richNoLayer']),clearable:s.bool,onClear:s.func,showPhoto:s.bool,highlightOnSelect:s.bool,presenter:s.object,inputID:s.string},m.propTypes),getDefaultProps:function(){return {viewStyle:'rich'};},componentWillMount:function(){},focusInput:function(){this.refs.typeahead&&this.refs.typeahead.focusInput();},blurInput:function(){this.refs.typeahead&&this.refs.typeahead.blurInput();},hideView:function(){this.refs.typeahead.hideView();},getTextFieldDOM:function(){return this.refs.typeahead.getTextFieldDOM();},_onClear:function(){this.props.onClear();setTimeout((function(){return this.focusInput();}).bind(this),0);},render:function(){var x="_55r1"+(!!this.props.tallInput?' '+"_55r2":''),y=null;if(this.props.presenter){y=this.props.presenter;}else if(this.props.viewStyle=='rich'){y=t;}else if(this.props.viewStyle=='richNoLayer'){y=u;}else y=v;if(!this.props.presenter&&this.props.maxEntries)y=r(y,{maxEntries:{$set:this.props.maxEntries}});var z=this.props.showPhoto&&this.props.selectedEntry?i.createElement(j,{className:"_wrl",src:this.props.selectedEntry.getPhoto()}):null,aa=this.props.clearable?i.createElement(l,{className:"_wrm"+(!this.props.queryString?' '+"hidden_elem":''),size:this.props.tallInput?'medium':'small',type:'button',onClick:this._onClear}):null,ba=this.props,ca=ba.className,da=babelHelpers.objectWithoutProperties(ba,['className']);return (i.createElement(m,this.props,i.createElement('span',{className:q("_wrn"+(!!this.props.tallInput?' '+"_213j":'')+(!!aa?' '+"_4ehf":'')+(!!z?' '+"_4ehg":'')+(!!this.props.queryString?' '+"_4in7":'')+(this.props.highlightOnSelect&&this.props.selectedEntry?' '+"_wrr":''),ca)},z,i.createElement(h,babelHelpers._extends({},da,{inputClassName:x,ref:'typeahead',presenter:y})),aa)));}});f.exports=w;},null);
__d("Collection",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j){if(!i.__collection__){var k=new Function();for(var l in i.prototype)k.prototype[l]=h._call.bind(null,l);i.__collection__=k;}var m=new i.__collection__();m._elements=j;return m;}h._call=function(i){var j=Array.prototype.slice.call(arguments,1);this._elements.forEach(function(k){k[i].apply(k,j);});return this;};f.exports=h;},null);
__d('Drag',['Event','Arbiter','DOM','Style','Vector'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m={};m.currentDraggable=null;m.grab=function(n){if(m.currentDraggable)m._onmouseup();n.lastDragOver=null;m.attachDragEvents();m.currentDraggable=n;};m.attachDragEvents=function(){document.onselectstart=function(){document.onselectstart=null;return false;};if(m.dragEventsAttached)return;m.dragEventsAttached=true;i.subscribe('scroller/scroll',m._onmousemove);h.listen(document,{mousemove:m._onmousemove,mouseup:m._onmouseup});};m.droppables={};m.addDroppable=function(n,o){(m.droppables[n]=m.droppables[n]||[]).push(o);};m.removeDroppable=function(n,o){m.droppables[n]=m.droppables[n].filter(function(p){return p!=o;});};m.getOffsetParent=function(n){if(j.isNodeOfType(n,['body','html']))return document.body;while((n=n.parentNode)&&n!==document.body)if(k.get(n,'position')!=='static')return n;return document.body;};m._onmousemove=function(event,n){if(!m.currentDraggable)return;var o=n||l.getEventPosition(event),p=m.currentDraggable,q=m.droppables[p.namespace];if(p.namespace&&p.active&&q){var r={};q.forEach(function(x){r[x.zIndex]=x.zIndex;});var s=[];for(var t in r)s.push(r[t]);s.sort();var u=p.lastDragOver,v=null;for(var w=s.length-1;w>=0;w--)if(u&&u.dom!=null&&u.zIndex==s[w]&&u.isDraggedOver(o)){v=u;break;}else for(t=0;t<q.length;t++){if(s[w]!=q[t].zIndex)continue;if(u!=q[t]&&p.dom!=q[t].dom&&q[t].isDraggedOver(o)){v=q[t];w=-1;break;}}if(v&&v!=u){v.ondragover(p);m.currentDraggable.adjustCursorPosition();}if(v)v.ondragmove(p,o.sub(l.getElementPosition(v.dom)));p.lastDragOver=v;}m.currentDraggable._onmousemove(o);};m._onmouseup=function(n){document.onselectstart=null;if(m.currentDraggable){m.currentDraggable._ondrop();m.currentDraggable=null;}};f.exports=m;},null);
__d('Draggable',['Event','Arbiter','Collection','DOM','Drag','Rect','Style','Vector','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();function q(s){'use strict';this.canvas=s;this.scrollZone=50;this.velocity=100;this.coefficient=1;}q.prototype.activate=function(){'use strict';this.activate=p;this.event=h.listen(document,'mousemove',this._onmousemove.bind(this));this.interval=setInterval(this._intervalHandler.bind(this),50);this.cursor=null;};q.prototype.deactivate=function(){'use strict';delete this.activate;this.event&&this.event.remove();this.event=null;clearInterval(this.interval);};q.prototype._onmousemove=function(event){'use strict';this.cursor=o.getEventPosition(event);};q.prototype._intervalHandler=function(){'use strict';if(!this.cursor)return;var s=this.canvas==document.body?m.getViewportBounds():new m(this.canvas),t=new m(this.cursor.y-s.t,s.r-this.cursor.x,s.b-this.cursor.y,this.cursor.x-s.l),u=new o(0,0);if(t.t<t.b&&t.t<this.scrollZone){u.y=-this.scrollZone+t.t;}else if(t.b<this.scrollZone)u.y=this.scrollZone-t.b;u.y=this._doMath(u.y);if(t.l<t.r&&t.l<this.scrollZone){u.x=-this.scrollZone+t.l;}else if(t.r<this.scrollZone)u.x=this.scrollZone-t.r;u.x=this._doMath(u.x);if(u.x||u.y){u.scrollElementBy(this.canvas);if(document.body==this.canvas){var v=o.getScrollPosition();u.scrollElementBy(this.canvas);var w=o.getScrollPosition();this.cursor=this.cursor.add(w.sub(v));}else u.scrollElementBy(this.canvas);i.inform('scroller/scroll',this.cursor);}};q.prototype._doMath=function(s){'use strict';s=s>=0?Math.min(s,this.scrollZone):Math.max(s,-this.scrollZone);return Math.floor(Math.pow(s/this.scrollZone*this.velocity,this.coefficient));};q.findScrollParent=function(s){'use strict';var t;s=s.parentNode;while(s){if(s.scrollHeight!=s.offsetTop){t=n.get(s,'overflowY');if(t=='scroll'||t=='auto')return s;}s=s.parentNode;}return document.body;};function r(s){'use strict';if(!s)throw new Error('Element should be a DOM node');if(!(this instanceof r)){if(s instanceof Array){var t=[];s.forEach(function(u){t.push(new r(u));});return new j(r,t);}else return new r(s);}else{this.data={};this.handles=[];this.dom=s;this.boundingBox=null;this.useScroller=true;this.grabPctX=this.grabPctY=0;this._shouldKillEvents=true;this.addHandle(this.dom);}}r.prototype.destroy=function(){'use strict';this.handles.forEach((function(s){this.removeHandle(s.obj);}).bind(this));this.data=this.dom=null;};r.prototype.adjustCursorPosition=function(){'use strict';var s=o.getElementDimensions(this.dom);this.cursorPositionVector=new o(parseInt(this.grabPctX*s.x,10),parseInt(this.grabPctY*s.y,10));};r.prototype._onclick=function(event){'use strict';if(!this._shouldKillEvents)return true;if(this.active)return h.kill(event);};r.prototype._ongrab=function(s){'use strict';this.ongrab();if(this.useScroller){if(!this.scroller)this.scroller=new q(q.findScrollParent(this.dom));this.scroller.activate();}if(this.active){if(!this.oldPosition)this.oldPosition=this.dom.style.position;var t=l.getOffsetParent(this.dom);if(t!==document.body)s=s.sub(o.getElementPosition(t));this.dom.style.position=this.absolute?'absolute':'relative';s.sub(this.cursorPositionVector).setElementPosition(this.dom);}};r.prototype._onmousedown=function(event){'use strict';if(!(event.which&&event.which===1||event.button&&event.button===1))return;var s=event.getTarget();if(k.isNodeOfType(s,['input','select','textarea','object','embed']))return true;var t=o.getEventPosition(event),u=o.getElementDimensions(this.dom);this.draggableInitialVector=o.getElementPosition(this.dom);this.cursorPositionVector=t.sub(this.draggableInitialVector);this.grabPctX=u.x===0?0:this.cursorPositionVector.x/u.x;this.grabPctY=u.y===0?0:this.cursorPositionVector.y/u.y;l.grab(this,event);if(this.gutter){this.cursorInitialVector=t;}else{this._setActive(true);this._ongrab(t);}if(!this._shouldKillEvents)return true;return h.kill(event);};r.prototype._onmousemove=function(s){'use strict';if(!this.active)if(s.distanceTo(this.cursorInitialVector)>=this.gutter){this._setActive(true);this._ongrab(s);}if(this.active){var t=s.sub(this.cursorPositionVector),u;if(this.boundingBox){var v=m.newFromVectors(t,o.getElementDimensions(this.dom));v=v.boundWithin(this.boundingBox);t=v.getPositionVector();if(this.boundingBox.w()===0){u=new o(this.draggableInitialVector.x,t.y,'document');}else if(this.boundingBox.h()===0){u=new o(t.x,this.draggableInitialVector.y,'document');}else u=t;}else u=t;var w=l.getOffsetParent(this.dom);if(w!==document.body)u=u.sub(o.getElementPosition(w));u.setElementPosition(this.dom);this.ondrag(s);}};r.prototype._ondrop=function(){'use strict';this.scroller&&this.scroller.deactivate();if(this.active){setTimeout((function(){this._setActive(false);}).bind(this),0);this.ondrop(this.scroller&&this.scroller.cursor);if(this.lastDragOver)this.lastDragOver.ondrop(this);}};r.prototype.killDrag=function(){'use strict';this._setActive(false);l._onmouseup();};r.prototype.forceDrop=function(){'use strict';l._onmouseup();};r.prototype.setBoundingBox=function(s){'use strict';this.boundingBox=s;return this;};r.prototype.resetPosition=function(){'use strict';this.dom.style.position=this.oldPosition;this.oldPosition=null;this.dom.style.left='';this.dom.style.top='';return this;};r.prototype.setUseAbsolute=function(s){'use strict';this.absolute=s;return this;};r.prototype.setDragHandler=function(s){'use strict';this.ondrag=s;return this;};r.prototype.setGrabHandler=function(s){'use strict';this.ongrab=s;return this;};r.prototype.setDropHandler=function(s){'use strict';this.ondrop=s;return this;};r.prototype.setGutter=function(s){'use strict';this.gutter=s;return this;};r.prototype.setNamespace=function(s){'use strict';this.namespace=s;return this;};r.prototype.setUseScroller=function(s){'use strict';this.useScroller=s;return this;};r.prototype.setAvoidKillingEvents=function(s){'use strict';this._shouldKillEvents=!s;return this;};r.prototype.addHandle=function(s){'use strict';if(this.handles.length==1&&this.handles[0].obj==this.dom)this.removeHandle(this.dom);this.handles.push({obj:s,evt:[h.listen(s,'mousedown',this._onmousedown.bind(this)),h.listen(s,'click',this._onclick.bind(this)),h.listen(s,'drag',this._killUnlessActive.bind(this)),h.listen(s,'selectstart',this._killUnlessActive.bind(this))]});return this;};r.prototype.removeHandle=function(s){'use strict';this.handles=this.handles.filter(function(t){if(t.obj!=s){return true;}else{t.evt.forEach(function(u){u.remove();});return false;}});};r.prototype.getDOM=function(){'use strict';return this.dom;};r.prototype.setKey=function(s,t){'use strict';this.data[s]=t;return this;};r.prototype.getKey=function(s){'use strict';return this.data[s];};r.prototype._setActive=function(s){'use strict';if(!this.dom)return;this.dom.activeDrag=this.active=s;for(var t=0;t<this.handles.length;t++)this.handles[t].obj.activeDrag=s;};r.prototype._killUnlessActive=function(s){'use strict';if(!this._shouldKillEvents)return;if(s.getTarget()!==document.activeElement)return s.kill();};r.prototype.ondrag=p;r.prototype.ongrab=p;r.prototype.ondrop=p;r.prototype.gutter=0;r.prototype.handles=null;f.exports=r;},null);