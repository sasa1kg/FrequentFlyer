/*!CK:3497991745!*//*1451895139,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["gHtl1"]); }

__d("OptimisticVideoPostEvent",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={VIDEO_POST_ADDED:"video_post_added",VIDEO_POST_REMOVED:"video_post_removed",POST_REMOVED_WITHOUT_REPLACEMENT:"post_removed_without_replacement"};},null);
__d("OptimisticVideoPostSource",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={PAGES_TIMELINE:"pages_timeline",VIDEO_HUB:"video_hub",USERS_TIMELINE:"users_timeline"};},null);
__d("VideoEditSource",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={PROCESSING_DIALOG:"processing_dialog",OPTIMISTIC_VIDEO_POST:"optimistic_video_post",VIDEO_ASSET_INSIGHTS:"video_asset_insights",PERMALINK:"permalink",TIMELINE:"timeline",SNOWLIFT:"snowlift",LIBRARY:"library",REFERENCE_LIBRARY:"reference_library",UNKNOWN:"unknown"};},null);
__d('FBProfilePhotoShadow.react',['React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=h.createClass({displayName:'FBProfilePhotoShadow',render:function(){var l=this.props,m=l.className,n=l.children,o=babelHelpers.objectWithoutProperties(l,['className','children']),p=h.Children.only(n);return (h.createElement('div',babelHelpers._extends({},o,{className:j(m,"_38vo")}),h.cloneElement(p,{className:j(p.props.className,"_44ma")})));}});f.exports=k;},null);
__d('OptimisticPostMetadata.react',['React','XUIText.react','Link.react','BackgroundImage.react','cx','getDOMImageSize'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=470,o=263,p=472,q=h.createClass({displayName:'OptimisticPostMetadata',componentDidMount:function(){m(this.props.image,this.onGetSize);},getInitialState:function(){return {height:o};},onGetSize:function(r,s,t){var u=r<s?n:o;this.setState({height:u});},render:function(){return (h.createElement('div',null,h.createElement('div',{className:"_1gi0"},h.createElement(i,{size:'medium',weight:'bold',display:'block'},h.createElement(j,null,this.props.title)),h.createElement(i,{size:'medium',weight:'normal',display:'block'},this.props.description)),h.createElement('div',{className:"_2bc-"},h.createElement(k,{src:this.props.image,backgroundSize:'contain',width:p,height:this.state.height}))));}});f.exports=q;},null);
__d('VideoThumbnail',['invariant'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this.$VideoThumbnail1=j;}i.prototype.getURL=function(){'use strict';return this.$VideoThumbnail1;};i.prototype.getData=function(){'use strict';h(0);};f.exports=i;},null);
__d('CanvasToBlobImpl',['BlobFactory'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j,k){var l=atob(j.substr(j.indexOf(',')+1)),m=new Uint8Array(l.length);for(var n=0;n<l.length;n++)m[n]=l.charCodeAt(n);return h.getBlob([m],{type:k});}f.exports={getBlob:i};},null);
__d('canvasToBlob',['Promise','BlobFactory','CanvasToBlobResource','WebWorker','CanvasToBlobImpl'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=c('CanvasToBlobImpl').getBlob,m=b.URL||b.webkitURL||{};function n(p,q,r){return new h(function(s,t){if(p.toBlob){p.toBlob(s,q,r);}else{var u=p.toDataURL(q,r);o(u,q).then(function(v){s(v);},t);}});}function o(p,q){if(!m.createObjectURL||!i.isSupported)return h.reject("Browser doesn't support this feature");if(k.isSupported()){return new h(function(r,s){var t=new k(j).setMessageHandler(function(u){r(u);t.terminate();}).setErrorHandler(function(event){s(event.message);t.terminate();}).execute().postMessage({dataURL:p,fileType:q});});}else return h.resolve(l(p,q));}f.exports=n;},null);
__d('CanvasVideoThumbnail',['Promise','DOM','EventListener','VideoThumbnail','canvasToBlob'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m,n;m=babelHelpers.inherits(o,k);n=m&&m.prototype;function o(p,q,r){'use strict';n.constructor.call(this,null);this.$CanvasVideoThumbnail1=p;this.$CanvasVideoThumbnail2=q;this.$CanvasVideoThumbnail3=r;}o.prototype.getURL=function(){'use strict';if(!this.$CanvasVideoThumbnail4)this.$CanvasVideoThumbnail4=this.$CanvasVideoThumbnail1.toDataURL('image/jpeg');return this.$CanvasVideoThumbnail4;};o.prototype.getData=function(){'use strict';var p=i.create('canvas'),q=p.getContext('2d'),r=this.$CanvasVideoThumbnail2;return new h((function(s,t){var u=j.listen(r,'seeked',function(){u.remove();p.width=r.videoWidth;p.height=r.videoHeight;q.drawImage(r,0,0,p.width,p.height);l(p,'image/jpeg').then(s,t);});r.currentTime=this.$CanvasVideoThumbnail3;}).bind(this));};f.exports=o;},null);
__d('generateVideoThumbnails',['Promise','CanvasVideoThumbnail','EventListener','VideoFrameBuffer','VideoThumbnail'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();function m(n,o,p,q){return new h(function(r,s){var t=document.createElement('canvas'),u=[],v=0,w=n.duration/q,x=new l(''),y=new k(t,n,'contain'),z;t.width=o;t.height=p;var aa=function(){y.updateFrameBuffer();var ca=new i(t,n,(v-1)*w);u.push(ca);if(ca.getURL().length>x.getURL().length)x=ca;ba();},ba=function(){if(v===0)z=j.listen(n,'seeked',aa);if(v<q){n.currentTime=v*w;v++;}else{if(z)z.remove();r({thumbnails:u,selectedThumbnail:x});}};if(n.videoWidth===0||n.videoHeight===0){s();return;}ba();});}f.exports=m;},null);
__d('OptimisticPostMetadataWithoutThumbnail.react',['EventListener','OptimisticPostMetadata.react','React','ReactDOM','cx','generateVideoThumbnails'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n=j.createClass({displayName:'OptimisticPostMetadataWithoutThumbnail',_loadedmetadataListener:null,getInitialState:function(){return {thumbnail:''};},componentDidMount:function(){var o=k.findDOMNode(this.refs.videoPlayer);this._loadedmetadataListener=h.listen(o,'loadedmetadata',this.generateVideoThumbnails);},componentWillUnmount:function(){if(this._loadedmetadataListener){this._loadedmetadataListener.remove();this._loadedmetadataListener=null;}},generateVideoThumbnails:function(){var o=k.findDOMNode(this.refs.videoPlayer);m(o,200,200,1).done((function(p){this.setState({thumbnail:p.thumbnails[0].getURL()});}).bind(this));},render:function(){return (j.createElement('div',null,j.createElement(i,{title:this.props.title,description:this.props.description,image:this.state.thumbnail}),j.createElement('video',{key:'videoPlayer',ref:'videoPlayer',className:"_2mpk",src:this.props.videoFileUrl})));}});f.exports=n;},null);
__d('OptimisticPostUFISection.react',['Image.react','React','UFICommentLink.react','UFILikeLink.react','UFIShareLink.react','XUICardSection.react','XUIPopoverButton.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=' \u00b7 ',q=' \u0020 ',r=i.createClass({displayName:'OptimisticPostUFISection',getDefaultProps:function(){var s={showSlimUFI:true,truncateNumbers:false,inlineShareHighlight:true};return {ufiExperiments:s};},render:function(){var s=null;if(this.props.isPagePost)s=i.createElement('div',{className:"_1f6t _3uni"},i.createElement('div',{className:"_3m9g"},i.createElement('div',{className:"_40yk"},i.createElement(n,{haschevron:true,image:i.createElement(h,{width:16,height:16,src:this.props.profilePicture}),ref:'open-menu-button',suppressed:true,type:'button'}))));return (i.createElement(m,null,i.createElement('div',{className:"_57w"+(!this.props.ufiExperiments.showSlimUFI?' '+"_2-jb":'')},s,i.createElement('div',{className:"_a7s _3399"},i.createElement('div',{className:"_524d"},i.createElement('div',{className:"_42nr"},i.createElement('span',null,i.createElement(k,{likeAction:true,ufiExperiments:this.props.ufiExperiments})),i.createElement('span',null,i.createElement(j,null)),i.createElement('span',null,i.createElement(l,null))))))));}});f.exports=r;},null);
__d('StoryProfile.react',['BackgroundImage.react','FBProfilePhotoShadow.react','Image.react','ImageBlock.react','InlineBlock.react','Link.react','PrivacyConst','React','XUIGrayText.react','XUIText.react','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();var t=o.PropTypes,u=o.createClass({displayName:'StoryProfile',propTypes:{privacySetting:t.number.isRequired,privacyIndicator:t.object,profilePicture:t.string.isRequired,username:t.string.isRequired,uploadTime:t.string.isRequired,profileURL:t.string,openProfileURLInNewPage:t.bool,additionalLink:t.shape({URL:t.string,text:t.string})},getDefaultProps:function(){return {openProfileURLInNewPage:false};},_renderPrivacyIndicator:function(){if(this.props.privacyIndicator){return this.props.privacyIndicator;}else{var v=this.props.privacySetting==n.BaseValue.EVERYONE,w=this.props.privacySetting==n.BaseValue.ALL_FRIENDS;return (o.createElement(h,{width:13,height:12,className:"_14g-"+(v?' '+"_14g_":'')+(w?' '+"_5qhp":'')+(!w&&!v?' '+"_14h0":'')}));}},_renderProfileName:function(){var v,w;if(this.props.profileURL){var x;if(this.props.openProfileURLInNewPage)x='_blank';w='bold';v=o.createElement(m,{href:this.props.profileURL,target:x},this.props.username);}else v=this.props.username;return (o.createElement(q,{className:"_14gz",size:'medium',weight:w,display:'block'},v));},_renderAdditionalLink:function(){if(this.props.additionalLink)return (o.createElement(p,{shade:'light',size:'small',display:'inline'},' · ',o.createElement(m,{href:this.props.additionalLink.URL,target:'_blank'},this.props.additionalLink.text)));return null;},render:function(){return (o.createElement(k,{spacing:'medium',className:s(this.props.className,"_56-3")},o.createElement(i,null,o.createElement(j,{className:"_56-4",src:this.props.profilePicture})),o.createElement(l,{alignv:'middle',height:40,fullWidth:true},this._renderProfileName(),o.createElement('div',null,o.createElement(p,{shade:'light',size:'small',display:'inline'},this.props.uploadTime,' · '),this._renderPrivacyIndicator(),this._renderAdditionalLink()))));}});f.exports=u;},null);
__d("XPagesManagerPublishingToolsController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/{page_token}\/publishing_tools\/",{current_page:{type:"Int"},section:{type:"String"},page_token:{type:"String",required:true},business_id:{type:"Int"}});},null);
__d('VideoLibraryButton.react',['React','URI','XPagesManagerPublishingToolsController','XUIDialogButton.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n,o;n=babelHelpers.inherits(p,h.Component);o=n&&n.prototype;p.prototype.$VideoLibraryButton1=function(){'use strict';return j.getURIBuilder().setString('page_token',this.props.pageID).setString('section','VIDEOS').getURI();};p.prototype.$VideoLibraryButton2=function(){'use strict';this.$VideoLibraryButton1().go();};p.prototype.render=function(){'use strict';return (h.createElement(k,{action:'cancel',className:"_2bhc",label:m._("Video Library"),size:this.props.size,onClick:this.$VideoLibraryButton2.bind(this)}));};function p(){'use strict';n.apply(this,arguments);}p.defaultProps={size:'small'};f.exports=p;},null);
__d("XVideoEditController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/video\/edit\/",{v:{type:"Int",required:true},album:{type:"Int"},source:{type:"Enum",enumType:1}});},null);
__d("XVideoEditDialogController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/video\/edit\/dialog\/",{video_id:{type:"Int"},source:{type:"Enum",enumType:1},story_dom_id:{type:"String"},timeline_identifier:{type:"String"},post_id:{type:"String"},video_asset_id:{type:"Int"},__asyncDialog:{type:"Int"}});},null);
__d('OptimisticVideoPost.react',['ActorURI','AsyncRequest','LeftRight.react','OptimisticPostMetadata.react','OptimisticPostMetadataWithoutThumbnail.react','OptimisticPostUFISection.react','PrivacyConst','ProgressBar.react','React','StoryProfile.react','VideoEditSource','VideoLibraryButton.react','VideoThumbnailConfig','XUIButton.react','XUICard.react','XUICardSection.react','fbt','cx','XVideoEditController','XVideoEditDialogController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba=p.PropTypes,ca=p.createClass({displayName:'OptimisticVideoPost',propTypes:{profilePicture:ba.string,username:ba.string,privacySetting:ba.number,metadataTitle:ba.string,metadataDescription:ba.string,thumbnail:ba.string,videoID:ba.string,isPagePost:ba.bool,shouldShowVideoEditDialog:ba.bool,targetID:ba.string,videoFileUrl:ba.string},getDefaultProps:function(){return {profilePicture:'',username:'',privacySetting:n.BaseValue.EVERYONE,metadataTitle:'',metadataDescription:'',thumbnail:'',progress:0,videoID:'',isPagePost:false,shouldShowVideoEditDialog:false,videoFileUrl:''};},getThumbnail:function(){if(this.props.thumbnail)return this.props.thumbnail;return t.defaultThumbnailURL;},onEditClick:function(){var da;if(this.props.shouldShowVideoEditDialog){da=aa.getURIBuilder().setInt('video_id',this.props.videoID).setEnum('source',r.OPTIMISTIC_VIDEO_POST).getURI();if(this.props.targetID)da=h.create(da,this.props.targetID);new i(da).send();}else{da=z.getURIBuilder().setInt('v',this.props.videoID).setEnum('source',r.OPTIMISTIC_VIDEO_POST).getURI();window.open(da,'_blank');}},render:function(){var da=x._("Just Now"),ea=x._("Preparing... {number}\u0025",[x.param('number',this.props.progress)]),fa=null;if(this.props.shouldShowVideoLibraryButton)fa=p.createElement(s,{pageID:this.props.targetID});var ga=this.props.shouldShowVideoLibraryButton,ha=p.createElement(w,{background:'light-wash'},p.createElement('div',{className:"_pro"},p.createElement('div',{className:"_2uu3"},p.createElement(j,{className:"_1mg"},p.createElement('div',null,p.createElement('span',null,p.createElement(o,{className:(!ga?"_1mh":'')+(ga?' '+"_1mi":''),value:this.props.progress,label:ea}))),p.createElement('div',null,fa,p.createElement(u,{className:"_4p26",label:'Edit',size:'small',onClick:this.onEditClick})))))),ia=this.props.profilePicture||'',ja=this.props.username||'',ka=this.props.privacySetting||-1,la=p.createElement(q,{className:"_4r8g",profilePicture:ia,username:ja,uploadTime:da,privacySetting:ka}),ma=this.props.thumbnail?p.createElement(k,{title:this.props.metadataTitle,description:this.props.metadataDescription,image:this.getThumbnail()}):p.createElement(l,{title:this.props.metadataTitle,description:this.props.metadataDescription,videoFileUrl:this.props.videoFileUrl}),na=x._("Boost Post"),oa=this.props.isPagePost?p.createElement('div',{className:"_5c_1"},p.createElement(j,null,p.createElement('div',null),p.createElement(u,{label:na,use:'confirm'}))):null,pa=p.createElement(m,{ufiExperiments:this.props.ufiExperiments,profilePicture:this.props.profilePicture,isPagePost:this.props.isPagePost}),qa=p.createElement('div',null,la,ma,oa,pa),ra=p.createElement('div',{className:"_5c_3"});return (p.createElement('div',{className:!!this.props.isPagePost?"_5ctl":''},p.createElement(v,{className:"_4p28"},ha,p.createElement('div',{className:"_prq"},qa,ra))));}});f.exports=ca;},null);
__d('OptimisticVideoPostLogger',['BanzaiLogger'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={logEvent:function(event,j,k,l,m){h.log('OptimisticVideoPostLoggerConfig',{number_of_posts:k,source:j,event:event,target_id:l,video_id:m});}};f.exports=i;},null);
__d("OptimisticVideoPostUtils",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={shouldShowOptimisticPost:function(i){if(i.isScheduledPost||i.isHiddenFromTimeline||i.isSecret||!i.isPageToPage&&!i.isToUserProfile||i.isDraft)return false;return true;}};f.exports=h;},null);
__d("XVideoGenerateStoryController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/video\/generate_story\/",{video_id:{type:"Int"},feed_location:{type:"Enum",enumType:0},timeline_identifier:{type:"String"}});},null);
__d("XVideoOptimisticPostingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/video\/optimistic_posting\/",{video_id:{type:"Int",required:true}});},null);
__d('OptimisticVideoPostList.react',['Arbiter','AsyncRequest','ChannelConstants','FBFeedLocations','OptimisticVideoPost.react','OptimisticVideoPostEvent','OptimisticVideoPostLogger','OptimisticVideoPostSource','OptimisticVideoPostUtils','PagesComposer','React','ReactDOM','Run','TimelineComposer','XVideoGenerateStoryController','XVideoOptimisticPostingController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=b.URL||b.webkitURL||{},y='video_encode',z=7,aa=5000,ba=r.createClass({displayName:'OptimisticVideoPostList',getInitialState:function(){return {videoPostsMetadata:{},videoPosts:[]};},componentDidMount:function(){var ca=h.subscribe('videoUpload/complete',this.onVideoPostSubmitted),da=h.subscribe(this.getChannelType(),this.onEncodeUpdate);t.onLeave(function(){return ca.unsubscribe();});t.onLeave(function(){return da.unsubscribe();});if(this.props.data.length>0)this.initializePosts();},initializePosts:function(){var ca=[],da={};for(var ea=0;ea<this.props.data.length;ea++){if(!p.shouldShowOptimisticPost(this.props.data[ea]))break;var fa=babelHelpers._extends({},this.props.data[ea],{shouldRender:false});fa.progress=0;var ga=fa.videoID;fa.inactivityTimer=this.startInactivityTimer(ga);ca.push(ga);da[ga]=fa;}this.setState({videoPostsMetadata:da,videoPosts:ca});},getChannelType:function(){return j.getArbiterType(y);},updateVideoData:function(ca){var da={};da[ca.videoID]=babelHelpers._extends({},ca,{shouldRender:true,fakeProgressTimer:setInterval((function(){return this.fakeInitialProgress(ca.videoID);}).bind(this),700),inactivityTimer:this.startInactivityTimer(ca.videoID)});da[ca.videoID].progress=0;var ea=babelHelpers._extends({},this.state.videoPostsMetadata,da),fa=[ca.videoID].concat(this.state.videoPosts);this.setState({videoPostsMetadata:ea,videoPosts:fa});this.logEvent(m.VIDEO_POST_ADDED,ca.videoID);},onVideoPostSubmitted:function(ca,da){if(!p.shouldShowOptimisticPost(da))return;if(!da.isToUserProfile){this.updateVideoData(da);return;}var ea=w.getURIBuilder().setInt('video_id',da.videoID).getURI();new i().setURI(ea).setHandler((function(fa){this.updateVideoData(babelHelpers._extends({},fa.payload,{videoFileUrl:da.videoFileURL}));}).bind(this)).send();},checkVideoStatus:function(ca){new i().setURI('/ajax/video/encode/feedback/ping/').setData({video_id:ca}).setHandler((function(da){var ea=da.getPayload();if(da.error||ea.is_ready){this.onEncodeFinish(ca);}else this.restartInactivityTimer(ca);}).bind(this)).send();},startInactivityTimer:function(ca){return setTimeout((function(){return this.checkVideoStatus(ca);}).bind(this),aa);},restartInactivityTimer:function(ca){this.stopInactivityTimer(ca);var da=babelHelpers._extends({},this.state.videoPostsMetadata),ea=babelHelpers._extends({},da[ca]);ea.inactivityTimer=this.startInactivityTimer(ca);da[ca]=ea;this.setState({videoPostsMetadata:da});},stopInactivityTimer:function(ca){clearTimeout(this.state.videoPostsMetadata[ca].inactivityTimer);},logEvent:function(event,ca){n.logEvent(event,this.props.isPagePost?o.PAGES_TIMELINE:o.USERS_TIMELINE,this.state.videoPosts.length,this.props.targetID,ca);},fakeInitialProgress:function(ca){var da=this.state.videoPostsMetadata[ca].progress;if(da>z){this.stopFakeInitialProgress(ca);return;}var ea=babelHelpers._extends({},this.state.videoPostsMetadata),fa=babelHelpers._extends({},ea[ca]);fa.progress+=1;ea[ca]=fa;this.setState({videoPostsMetadata:ea});this.restartInactivityTimer(ca);},stopFakeInitialProgress:function(ca){if(!this.state.videoPostsMetadata[ca].fakeProgressTimer)return;var da=babelHelpers._extends({},this.state.videoPostsMetadata);clearTimeout(da[ca].fakeProgressTimer);var ea=babelHelpers._extends({},da[ca]);ea.fakeProgressTimer=null;da[ca]=ea;this.setState({videoPostsMetadata:da});},onEncodeUpdate:function(ca,da){var ea=String(da.obj.videoID);if(!this.state.videoPostsMetadata[ea])return;var fa=babelHelpers._extends({},this.state.videoPostsMetadata);if(da.obj.progress<fa[ea].progress)return;this.stopFakeInitialProgress(ea);var ga=babelHelpers._extends({},fa[ea]);ga.progress=da.obj.progress;ga.shouldRender=true;fa[ea]=ga;this.setState({videoPostsMetadata:fa});if(this._isEncodingFinished(da.obj.stage)){this.onEncodeFinish(ea);}else this.restartInactivityTimer(ea);},_isEncodingFinished:function(ca){return ca==='finish';},onEncodeFinish:function(ca){if(!this.state.videoPostsMetadata[ca])return;this.stopInactivityTimer(ca);var da=this.props.isPagePost?k.PAGE_TIMELINE:k.TIMELINE,ea=v.getURIBuilder().setInt('video_id',ca).setEnum('feed_location',da).getURI();new i().setURI(ea).setData({video_id:ca,feed_location:da}).setHandler((function(fa){return this.handleRequest(fa,ca);}).bind(this)).send();},handleRequest:function(ca,da){var ea=ca.payload;if(ea){if(this.props.isPagePost){q.renderStory(s.findDOMNode(this),ea);}else u.renderCapsuleBasedStory(s.findDOMNode(this),ea);}else this.logEvent(m.POST_REMOVED_WITHOUT_REPLACEMENT,da);this.removeOptimisticPost(da);},removeOptimisticPost:function(ca){var da=babelHelpers._extends({},this.state.videoPostsMetadata);delete da[ca];var ea=this.state.videoPosts;ea=this.removeVideoID(ea,ca);this.setState({videoPostsMetadata:da,videoPosts:ea});this.logEvent(m.VIDEO_POST_REMOVED,ca);},removeVideoID:function(ca,da){var ea=ca.indexOf(da);ca.splice(ea,1);return ca;},renderOptimisticPost:function(ca){if(!ca.shouldRender)return r.createElement('div',{key:ca.videoID});var da;if(ca.videoThumbnail){da=ca.videoThumbnail;}else if(x.createObjectURL&&ca&&ca.videoThumbnailBlob){da=x.createObjectURL(ca.videoThumbnailBlob);this.setThumbnailURL(da,ca.videoID);}else da='';return (r.createElement(l,{username:ca.userDisplayName,profilePicture:ca.userProfilePictureURI,metadataTitle:ca.videoTitle,metadataDescription:ca.videoDescription,thumbnail:da,videoID:ca.videoID,videoFileUrl:ca.videoFileUrl,key:ca.videoID,progress:ca.progress,ufiExperiments:this.props.ufiExperiments,privacySetting:ca.privacySetting,isPagePost:this.props.isPagePost,shouldShowVideoEditDialog:this.props.shouldShowVideoEditDialog,targetID:this.props.targetID,shouldShowVideoLibraryButton:this.props.shouldShowVideoLibraryButton}));},setThumbnailURL:function(ca,da){var ea=babelHelpers._extends({},this.state.videoPostsMetadata);ea[da].videoThumbnail=ca;this.setState({videoPostsMetadata:ea});},render:function(){var ca=this.state.videoPostsMetadata,da=this.state.videoPosts.map((function(ea){return this.renderOptimisticPost(ca[ea]);}).bind(this));return (r.createElement('ul',null,da));}});f.exports=ba;},null);
__d('OptimisticVideoPostController',['React','ReactDOM','CSS','OptimisticVideoPostList.react'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l={init:function(m,n,o,p,q,r,s){this._postsContainer=m;i.render(h.createElement(k,{data:n,targetID:o,isPagePost:p,ufiExperiments:q,shouldShowVideoEditDialog:r,shouldShowVideoLibraryButton:s}),this._postsContainer);j.show(this._postsContainer);}};f.exports=l;},null);